import{e as $,b as C,g as ct,c as I,d as Xe,_ as Dt,a as zt,k as Tt}from"./@babel-DAuA_VVL.js";import{c as ze}from"./classnames-D0qp76y0.js";import{R as ft}from"./rc-resize-observer-C-DzLP7k.js";import{x as U,u as Re,d as rt}from"./rc-util-BCTlEnPv.js";import{r as t}from"./react-DEe3I7kj.js";import{r as nt}from"./react-dom-DtE_-WSV.js";var vt=t.forwardRef(function(e,c){var v=e.height,o=e.offsetY,d=e.offsetX,g=e.children,s=e.prefixCls,u=e.onInnerResize,b=e.innerProps,h=e.rtl,R=e.extra,a={},S={display:"flex",flexDirection:"column"};return o!==void 0&&(a={height:v,position:"relative",overflow:"hidden"},S=$($({},S),{},C(C(C(C(C({transform:"translateY(".concat(o,"px)")},h?"marginRight":"marginLeft",-d),"position","absolute"),"left",0),"right",0),"top",0))),t.createElement("div",{style:a},t.createElement(ft,{onResize:function(m){var l=m.offsetHeight;l&&u&&u()}},t.createElement("div",ct({style:S,className:ze(C({},"".concat(s,"-holder-inner"),s)),ref:c},b),g,R)))});vt.displayName="Filler";function Ct(e){var c=e.children,v=e.setRef,o=t.useCallback(function(d){v(d)},[]);return t.cloneElement(c,{ref:o})}function It(e,c,v,o,d,g,s,u){var b=u.getKey;return e.slice(c,v+1).map(function(h,R){var a=c+R,S=s(h,a,{style:{width:o},offsetX:d}),i=b(h);return t.createElement(Ct,{key:i,setRef:function(l){return g(h,l)}},S)})}function Ht(e,c,v){var o=e.length,d=c.length,g,s;if(o===0&&d===0)return null;o<d?(g=e,s=c):(g=c,s=e);var u={__EMPTY_ITEM__:!0};function b(m){return m!==void 0?v(m):u}for(var h=null,R=Math.abs(o-d)!==1,a=0;a<s.length;a+=1){var S=b(g[a]),i=b(s[a]);if(S!==i){h=a,R=R||S!==b(s[a+1]);break}}return h===null?null:{index:h,multiple:R}}function Pt(e,c,v){var o=t.useState(e),d=I(o,2),g=d[0],s=d[1],u=t.useState(null),b=I(u,2),h=b[0],R=b[1];return t.useEffect(function(){var a=Ht(g||[],e||[],c);(a==null?void 0:a.index)!==void 0&&R(e[a.index]),s(e)},[e]),[h]}var at=(typeof navigator>"u"?"undefined":Xe(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const dt=function(e,c,v,o){var d=t.useRef(!1),g=t.useRef(null);function s(){clearTimeout(g.current),d.current=!0,g.current=setTimeout(function(){d.current=!1},50)}var u=t.useRef({top:e,bottom:c,left:v,right:o});return u.current.top=e,u.current.bottom=c,u.current.left=v,u.current.right=o,function(b,h){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=b?h<0&&u.current.left||h>0&&u.current.right:h<0&&u.current.top||h>0&&u.current.bottom;return R&&a?(clearTimeout(g.current),d.current=!1):(!a||d.current)&&s(),!d.current&&a}};function Ot(e,c,v,o,d,g,s){var u=t.useRef(0),b=t.useRef(null),h=t.useRef(null),R=t.useRef(!1),a=dt(c,v,o,d);function S(f,y){if(U.cancel(b.current),!a(!1,y)){var w=f;if(!w._virtualHandled)w._virtualHandled=!0;else return;u.current+=y,h.current=y,at||w.preventDefault(),b.current=U(function(){var P=R.current?10:1;s(u.current*P,!1),u.current=0})}}function i(f,y){s(y,!0),at||f.preventDefault()}var m=t.useRef(null),l=t.useRef(null);function E(f){if(e){U.cancel(l.current),l.current=U(function(){m.current=null},2);var y=f.deltaX,w=f.deltaY,P=f.shiftKey,O=y,x=w;(m.current==="sx"||!m.current&&P&&w&&!y)&&(O=w,x=0,m.current="sx");var k=Math.abs(O),Y=Math.abs(x);m.current===null&&(m.current=g&&k>Y?"x":"y"),m.current==="y"?S(f,x):i(f,O)}}function M(f){e&&(R.current=f.detail===h.current)}return[E,M]}function kt(e,c,v,o){var d=t.useMemo(function(){return[new Map,[]]},[e,v.id,o]),g=I(d,2),s=g[0],u=g[1],b=function(R){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,S=s.get(R),i=s.get(a);if(S===void 0||i===void 0)for(var m=e.length,l=u.length;l<m;l+=1){var E,M=e[l],f=c(M);s.set(f,l);var y=(E=v.get(f))!==null&&E!==void 0?E:o;if(u[l]=(u[l-1]||0)+y,f===R&&(S=l),f===a&&(i=l),S!==void 0&&i!==void 0)break}return{top:u[S-1]||0,bottom:u[i]}};return b}var Nt=function(){function e(){zt(this,e),C(this,"maps",void 0),C(this,"id",0),C(this,"diffRecords",new Map),this.maps=Object.create(null)}return Dt(e,[{key:"set",value:function(v,o){this.diffRecords.set(v,this.maps[v]),this.maps[v]=o,this.id+=1}},{key:"get",value:function(v){return this.maps[v]}},{key:"resetRecord",value:function(){this.diffRecords.clear()}},{key:"getRecord",value:function(){return this.diffRecords}}]),e}();function it(e){var c=parseFloat(e);return isNaN(c)?0:c}function $t(e,c,v){var o=t.useState(0),d=I(o,2),g=d[0],s=d[1],u=t.useRef(new Map),b=t.useRef(new Nt),h=t.useRef(0);function R(){h.current+=1}function a(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;R();var m=function(){var M=!1;u.current.forEach(function(f,y){if(f&&f.offsetParent){var w=f.offsetHeight,P=getComputedStyle(f),O=P.marginTop,x=P.marginBottom,k=it(O),Y=it(x),A=w+k+Y;b.current.get(y)!==A&&(b.current.set(y,A),M=!0)}}),M&&s(function(f){return f+1})};if(i)m();else{h.current+=1;var l=h.current;Promise.resolve().then(function(){l===h.current&&m()})}}function S(i,m){var l=e(i);u.current.get(l),m?(u.current.set(l,m),a()):u.current.delete(l)}return t.useEffect(function(){return R},[]),[S,a,b.current,g]}var ot=14/15;function Bt(e,c,v){var o=t.useRef(!1),d=t.useRef(0),g=t.useRef(0),s=t.useRef(null),u=t.useRef(null),b,h=function(i){if(o.current){var m=Math.ceil(i.touches[0].pageX),l=Math.ceil(i.touches[0].pageY),E=d.current-m,M=g.current-l,f=Math.abs(E)>Math.abs(M);f?d.current=m:g.current=l;var y=v(f,f?E:M,!1,i);y&&i.preventDefault(),clearInterval(u.current),y&&(u.current=setInterval(function(){f?E*=ot:M*=ot;var w=Math.floor(f?E:M);(!v(f,w,!0)||Math.abs(w)<=.1)&&clearInterval(u.current)},16))}},R=function(){o.current=!1,b()},a=function(i){b(),i.touches.length===1&&!o.current&&(o.current=!0,d.current=Math.ceil(i.touches[0].pageX),g.current=Math.ceil(i.touches[0].pageY),s.current=i.target,s.current.addEventListener("touchmove",h,{passive:!1}),s.current.addEventListener("touchend",R,{passive:!0}))};b=function(){s.current&&(s.current.removeEventListener("touchmove",h),s.current.removeEventListener("touchend",R))},Re(function(){return e&&c.current.addEventListener("touchstart",a,{passive:!0}),function(){var S;(S=c.current)===null||S===void 0||S.removeEventListener("touchstart",a),b(),clearInterval(u.current)}},[e])}function ut(e){return Math.floor(Math.pow(e,.5))}function Ye(e,c){var v="touches"in e?e.touches[0]:e;return v[c?"pageX":"pageY"]-window[c?"scrollX":"scrollY"]}function Ft(e,c,v){t.useEffect(function(){var o=c.current;if(e&&o){var d=!1,g,s,u=function(){U.cancel(g)},b=function S(){u(),g=U(function(){v(s),S()})},h=function(i){if(!(i.target.draggable||i.button!==0)){var m=i;m._virtualHandled||(m._virtualHandled=!0,d=!0)}},R=function(){d=!1,u()},a=function(i){if(d){var m=Ye(i,!1),l=o.getBoundingClientRect(),E=l.top,M=l.bottom;if(m<=E){var f=E-m;s=-ut(f),b()}else if(m>=M){var y=m-M;s=ut(y),b()}else u()}};return o.addEventListener("mousedown",h),o.ownerDocument.addEventListener("mouseup",R),o.ownerDocument.addEventListener("mousemove",a),function(){o.removeEventListener("mousedown",h),o.ownerDocument.removeEventListener("mouseup",R),o.ownerDocument.removeEventListener("mousemove",a),u()}}},[e])}var Yt=10;function Xt(e,c,v,o,d,g,s,u){var b=t.useRef(),h=t.useState(null),R=I(h,2),a=R[0],S=R[1];return Re(function(){if(a&&a.times<Yt){if(!e.current){S(function(re){return $({},re)});return}g();var i=a.targetAlign,m=a.originAlign,l=a.index,E=a.offset,M=e.current.clientHeight,f=!1,y=i,w=null;if(M){for(var P=i||m,O=0,x=0,k=0,Y=Math.min(c.length-1,l),A=0;A<=Y;A+=1){var B=d(c[A]);x=O;var J=v.get(B);k=x+(J===void 0?o:J),O=k}for(var V=P==="top"?E:M-E,Q=Y;Q>=0;Q-=1){var ee=d(c[Q]),H=v.get(ee);if(H===void 0){f=!0;break}if(V-=H,V<=0)break}switch(P){case"top":w=x-E;break;case"bottom":w=k-M+E;break;default:{var te=e.current.scrollTop,N=te+M;x<te?y="top":k>N&&(y="bottom")}}w!==null&&s(w),w!==a.lastTop&&(f=!0)}f&&S($($({},a),{},{times:a.times+1,targetAlign:y,lastTop:w}))}},[a,e.current]),function(i){if(i==null){u();return}if(U.cancel(b.current),typeof i=="number")s(i);else if(i&&Xe(i)==="object"){var m,l=i.align;"index"in i?m=i.index:m=c.findIndex(function(f){return d(f)===i.key});var E=i.offset,M=E===void 0?0:E;S({times:0,index:m,offset:M,originAlign:l})}}}var lt=t.forwardRef(function(e,c){var v=e.prefixCls,o=e.rtl,d=e.scrollOffset,g=e.scrollRange,s=e.onStartMove,u=e.onStopMove,b=e.onScroll,h=e.horizontal,R=e.spinSize,a=e.containerSize,S=e.style,i=e.thumbStyle,m=e.showScrollBar,l=t.useState(!1),E=I(l,2),M=E[0],f=E[1],y=t.useState(null),w=I(y,2),P=w[0],O=w[1],x=t.useState(null),k=I(x,2),Y=k[0],A=k[1],B=!o,J=t.useRef(),V=t.useRef(),Q=t.useState(m),ee=I(Q,2),H=ee[0],te=ee[1],N=t.useRef(),re=function(){m===!0||m===!1||(clearTimeout(N.current),te(!0),N.current=setTimeout(function(){te(!1)},3e3))},j=g-a||0,X=a-R||0,ue=t.useMemo(function(){if(d===0||j===0)return 0;var F=d/j;return F*X},[d,j,X]),_=function(D){D.stopPropagation(),D.preventDefault()},K=t.useRef({top:ue,dragging:M,pageY:P,startTop:Y});K.current={top:ue,dragging:M,pageY:P,startTop:Y};var le=function(D){f(!0),O(Ye(D,h)),A(K.current.top),s(),D.stopPropagation(),D.preventDefault()};t.useEffect(function(){var F=function(he){he.preventDefault()},D=J.current,z=V.current;return D.addEventListener("touchstart",F,{passive:!1}),z.addEventListener("touchstart",le,{passive:!1}),function(){D.removeEventListener("touchstart",F),z.removeEventListener("touchstart",le)}},[]);var ve=t.useRef();ve.current=j;var pe=t.useRef();pe.current=X,t.useEffect(function(){if(M){var F,D=function(he){var se=K.current,Te=se.dragging,be=se.pageY,Me=se.startTop;U.cancel(F);var me=J.current.getBoundingClientRect(),Ce=a/(h?me.width:me.height);if(Te){var Z=(Ye(he,h)-be)*Ce,ce=Me;!B&&h?ce-=Z:ce+=Z;var Ee=ve.current,ye=pe.current,Ie=ye?ce/ye:0,ae=Math.ceil(Ie*Ee);ae=Math.max(ae,0),ae=Math.min(ae,Ee),F=U(function(){b(ae,h)})}},z=function(){f(!1),u()};return window.addEventListener("mousemove",D,{passive:!0}),window.addEventListener("touchmove",D,{passive:!0}),window.addEventListener("mouseup",z,{passive:!0}),window.addEventListener("touchend",z,{passive:!0}),function(){window.removeEventListener("mousemove",D),window.removeEventListener("touchmove",D),window.removeEventListener("mouseup",z),window.removeEventListener("touchend",z),U.cancel(F)}}},[M]),t.useEffect(function(){return re(),function(){clearTimeout(N.current)}},[d]),t.useImperativeHandle(c,function(){return{delayHidden:re}});var G="".concat(v,"-scrollbar"),W={position:"absolute",visibility:H?null:"hidden"},de={position:"absolute",borderRadius:99,background:"var(--rc-virtual-list-scrollbar-bg, rgba(0, 0, 0, 0.5))",cursor:"pointer",userSelect:"none"};return h?(Object.assign(W,{height:8,left:0,right:0,bottom:0}),Object.assign(de,C({height:"100%",width:R},B?"left":"right",ue))):(Object.assign(W,C({width:8,top:0,bottom:0},B?"right":"left",0)),Object.assign(de,{width:"100%",height:R,top:ue})),t.createElement("div",{ref:J,className:ze(G,C(C(C({},"".concat(G,"-horizontal"),h),"".concat(G,"-vertical"),!h),"".concat(G,"-visible"),H)),style:$($({},W),S),onMouseDown:_,onMouseMove:re},t.createElement("div",{ref:V,className:ze("".concat(G,"-thumb"),C({},"".concat(G,"-thumb-moving"),M)),style:$($({},de),i),onMouseDown:le}))}),Wt=20;function st(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=e/c*e;return isNaN(v)&&(v=0),v=Math.max(v,Wt),Math.floor(v)}var jt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles","showScrollBar"],At=[],Vt={overflowY:"auto",overflowAnchor:"none"};function Kt(e,c){var v=e.prefixCls,o=v===void 0?"rc-virtual-list":v,d=e.className,g=e.height,s=e.itemHeight,u=e.fullHeight,b=u===void 0?!0:u,h=e.style,R=e.data,a=e.children,S=e.itemKey,i=e.virtual,m=e.direction,l=e.scrollWidth,E=e.component,M=E===void 0?"div":E,f=e.onScroll,y=e.onVirtualScroll,w=e.onVisibleChange,P=e.innerProps,O=e.extraRender,x=e.styles,k=e.showScrollBar,Y=k===void 0?"optional":k,A=Tt(e,jt),B=t.useCallback(function(n){return typeof S=="function"?S(n):n==null?void 0:n[S]},[S]),J=$t(B),V=I(J,4),Q=V[0],ee=V[1],H=V[2],te=V[3],N=!!(i!==!1&&g&&s),re=t.useMemo(function(){return Object.values(H.maps).reduce(function(n,r){return n+r},0)},[H.id,H.maps]),j=N&&R&&(Math.max(s*R.length,re)>g||!!l),X=m==="rtl",ue=ze(o,C({},"".concat(o,"-rtl"),X),d),_=R||At,K=t.useRef(),le=t.useRef(),ve=t.useRef(),pe=t.useState(0),G=I(pe,2),W=G[0],de=G[1],F=t.useState(0),D=I(F,2),z=D[0],ne=D[1],he=t.useState(!1),se=I(he,2),Te=se[0],be=se[1],Me=function(){be(!0)},me=function(){be(!1)},Ce={getKey:B};function Z(n){de(function(r){var p;typeof n=="function"?p=n(r):p=n;var L=pt(p);return K.current.scrollTop=L,L})}var ce=t.useRef({start:0,end:_.length}),Ee=t.useRef(),ye=Pt(_,B),Ie=I(ye,1),ae=Ie[0];Ee.current=ae;var we=t.useMemo(function(){if(!N)return{scrollHeight:void 0,start:0,end:_.length-1,offset:void 0};if(!j){var n;return{scrollHeight:((n=le.current)===null||n===void 0?void 0:n.offsetHeight)||0,start:0,end:_.length-1,offset:void 0}}for(var r=0,p,L,T,De=_.length,oe=0;oe<De;oe+=1){var Be=_[oe],_t=B(Be),tt=H.get(_t),Fe=r+(tt===void 0?s:tt);Fe>=W&&p===void 0&&(p=oe,L=r),Fe>W+g&&T===void 0&&(T=oe),r=Fe}return p===void 0&&(p=0,L=0,T=Math.ceil(g/s)),T===void 0&&(T=_.length-1),T=Math.min(T+1,_.length-1),{scrollHeight:r,start:p,end:T,offset:L}},[j,N,W,_,te,g]),ie=we.scrollHeight,fe=we.start,ge=we.end,We=we.offset;ce.current.start=fe,ce.current.end=ge,t.useLayoutEffect(function(){var n=H.getRecord();if(n.size===1){var r=Array.from(n.keys())[0],p=n.get(r),L=_[fe];if(L&&p===void 0){var T=B(L);if(T===r){var De=H.get(r),oe=De-s;Z(function(Be){return Be+oe})}}}H.resetRecord()},[ie]);var ht=t.useState({width:0,height:g}),je=I(ht,2),q=je[0],mt=je[1],gt=function(r){mt({width:r.offsetWidth,height:r.offsetHeight})},Ae=t.useRef(),Ve=t.useRef(),St=t.useMemo(function(){return st(q.width,l)},[q.width,l]),Rt=t.useMemo(function(){return st(q.height,ie)},[q.height,ie]),He=ie-g,Pe=t.useRef(He);Pe.current=He;function pt(n){var r=n;return Number.isNaN(Pe.current)||(r=Math.min(r,Pe.current)),r=Math.max(r,0),r}var xe=W<=0,Le=W>=He,Ke=z<=0,Ue=z>=l,bt=dt(xe,Le,Ke,Ue),Oe=function(){return{x:X?-z:z,y:W}},ke=t.useRef(Oe()),_e=rt(function(n){if(y){var r=$($({},Oe()),n);(ke.current.x!==r.x||ke.current.y!==r.y)&&(y(r),ke.current=r)}});function Ge(n,r){var p=n;r?(nt.flushSync(function(){ne(p)}),_e()):Z(p)}function Mt(n){var r=n.currentTarget.scrollTop;r!==W&&Z(r),f==null||f(n),_e()}var Ne=function(r){var p=r,L=l?l-q.width:0;return p=Math.max(p,0),p=Math.min(p,L),p},Et=rt(function(n,r){r?(nt.flushSync(function(){ne(function(p){var L=p+(X?-n:n);return Ne(L)})}),_e()):Z(function(p){var L=p+n;return L})}),yt=Ot(N,xe,Le,Ke,Ue,!!l,Et),Ze=I(yt,2),$e=Ze[0],qe=Ze[1];Bt(N,K,function(n,r,p,L){var T=L;return bt(n,r,p)?!1:!T||!T._virtualHandled?(T&&(T._virtualHandled=!0),$e({preventDefault:function(){},deltaX:n?r:0,deltaY:n?0:r}),!0):!1}),Ft(j,K,function(n){Z(function(r){return r+n})}),Re(function(){function n(p){var L=xe&&p.detail<0,T=Le&&p.detail>0;N&&!L&&!T&&p.preventDefault()}var r=K.current;return r.addEventListener("wheel",$e,{passive:!1}),r.addEventListener("DOMMouseScroll",qe,{passive:!0}),r.addEventListener("MozMousePixelScroll",n,{passive:!1}),function(){r.removeEventListener("wheel",$e),r.removeEventListener("DOMMouseScroll",qe),r.removeEventListener("MozMousePixelScroll",n)}},[N,xe,Le]),Re(function(){if(l){var n=Ne(z);ne(n),_e({x:n})}},[q.width,l]);var Je=function(){var r,p;(r=Ae.current)===null||r===void 0||r.delayHidden(),(p=Ve.current)===null||p===void 0||p.delayHidden()},Qe=Xt(K,_,H,s,B,function(){return ee(!0)},Z,Je);t.useImperativeHandle(c,function(){return{nativeElement:ve.current,getScrollInfo:Oe,scrollTo:function(r){function p(L){return L&&Xe(L)==="object"&&("left"in L||"top"in L)}p(r)?(r.left!==void 0&&ne(Ne(r.left)),Qe(r.top)):Qe(r)}}}),Re(function(){if(w){var n=_.slice(fe,ge+1);w(n,_)}},[fe,ge,_]);var wt=kt(_,B,H,s),xt=O==null?void 0:O({start:fe,end:ge,virtual:j,offsetX:z,offsetY:We,rtl:X,getSize:wt}),Lt=It(_,fe,ge,l,z,Q,a,Ce),Se=null;g&&(Se=$(C({},b?"height":"maxHeight",g),Vt),N&&(Se.overflowY="hidden",l&&(Se.overflowX="hidden"),Te&&(Se.pointerEvents="none")));var et={};return X&&(et.dir="rtl"),t.createElement("div",ct({ref:ve,style:$($({},h),{},{position:"relative"}),className:ue},et,A),t.createElement(ft,{onResize:gt},t.createElement(M,{className:"".concat(o,"-holder"),style:Se,ref:K,onScroll:Mt,onMouseEnter:Je},t.createElement(vt,{prefixCls:o,height:ie,offsetX:z,offsetY:We,scrollWidth:l,onInnerResize:ee,ref:le,innerProps:P,rtl:X,extra:xt},Lt))),j&&ie>g&&t.createElement(lt,{ref:Ae,prefixCls:o,scrollOffset:W,scrollRange:ie,rtl:X,onScroll:Ge,onStartMove:Me,onStopMove:me,spinSize:Rt,containerSize:q.height,style:x==null?void 0:x.verticalScrollBar,thumbStyle:x==null?void 0:x.verticalScrollBarThumb,showScrollBar:Y}),j&&l>q.width&&t.createElement(lt,{ref:Ve,prefixCls:o,scrollOffset:z,scrollRange:l,rtl:X,onScroll:Ge,onStartMove:Me,onStopMove:me,spinSize:St,containerSize:q.width,horizontal:!0,style:x==null?void 0:x.horizontalScrollBar,thumbStyle:x==null?void 0:x.horizontalScrollBarThumb,showScrollBar:Y}))}var Ut=t.forwardRef(Kt);Ut.displayName="List";export{Ut as L};
