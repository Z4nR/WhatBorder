import{j as e,r as g,a as Ht}from"./react-DEe3I7kj.js";import{b as Wt}from"./react-dom-DtE_-WSV.js";import{u as ye,a as O,b as X,Q as Jt,c as Gt,R as Yt}from"./@tanstack-C2Db2ou7.js";import{a as N}from"./axios-NIGUFBhG.js";import{c as De,p as Ie,a as Ae}from"./zustand-RbgjXlZ3.js";import{L as ce,S as Je,M as Zt,s as A,T as D,t as Le,B as C,a as B,b as Z,C as V,F as z,c as ge,R as ee,d as E,e as oe,f as $,E as it,g as je,h as W,i as Q,j as b,I as w,k as de,D as ke,P as Ne,A as Qt,l as Be,m as Vt,n as fe,o as re,p as ve,q as Xt,r as ea,u as ht}from"./antd-BQvygWmh.js";import{L as xe,B as ta}from"./react-router-dom-DGI2l1LK.js";import{u as te}from"./react-responsive-C7J1hSj9.js";import{Y as aa,Z as na,_ as sa,$ as ra,a0 as oa,a1 as ia,a2 as la,a3 as ca,a4 as da,a5 as ua,a6 as pa,a7 as $e,a8 as He,z as We,a9 as Fe,aa as gt,ab as xt,ac as ma,ad as ha,ae as ga,af as xa,o as H,X as yt,T as be,ag as jt,ah as kt,ai as Ge,aj as Ye,ak as Ze,v as ft}from"./@ant-design-D2hZJwPl.js";import{l as ya}from"./socket.io-client-COFPOLJh.js";import{c as lt}from"./chroma-js-DUfPS_J0.js";import{a as G,b as ja,O as Pe,d as Qe,e as Ve,f as ka,g as _}from"./react-router-Di0gpZDS.js";import{C as Me}from"./@antv-DEywjwVd.js";import{M as fa}from"./react-leaflet-cluster-FM7mhZ2M.js";import{M as ue,T as pe,a as bt,b as ba,S as Ta,G as Te,u as Tt,c as Ca}from"./react-leaflet-C22nh750.js";import{C as Ct}from"./crypto-js-DJu053Ks.js";import{c as St}from"./nanoid-jrp4UXyo.js";import{H as ne}from"./react-highlight-words-CthGDUU8.js";import{f as Sa,p as wa,i as va}from"./date-fns-Ba-O6Rcw.js";import{R as Pa}from"./@uiw-BvHB5c2H.js";import{G as Da,H as Ia,I as Aa}from"./@codemirror-DFlIbH2h.js";import"./@react-leaflet-DD_7zoy_.js";import"./leaflet-B_V4Pjd4.js";import"./scheduler-C323NY8X.js";import"./use-sync-external-store-BaPpfn7J.js";import"./rc-util-BCTlEnPv.js";import"./@babel-DAuA_VVL.js";import"./react-is-BpBQ4hf7.js";import"./classnames-D0qp76y0.js";import"./rc-resize-observer-C-DzLP7k.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-BhsrND7Q.js";import"./rc-overflow-CMENd3Rk.js";import"./rc-tabs-D9oTZbwC.js";import"./rc-dropdown-jp1YtJgi.js";import"./@rc-component-BqtN6ESW.js";import"./rc-menu-DrD5mXyZ.js";import"./rc-select-KozgNov_.js";import"./rc-virtual-list-DKEud5z_.js";import"./rc-segmented-CFHJh7Jn.js";import"./rc-input-number-BodzTaKX.js";import"./rc-input-CbIIXZWl.js";import"./rc-slider-D1Y-Hev1.js";import"./rc-field-form-BRNQb7Wh.js";import"./rc-dialog-C7slsWT-.js";import"./rc-notification-DvxTtLSs.js";import"./rc-tooltip-N4NpaNam.js";import"./rc-steps-305ZANuw.js";import"./rc-progress--oHY8mTg.js";import"./rc-switch-CYvoGUs6.js";import"./rc-table-C1s6WaN0.js";import"./rc-tree-DJ9f7vPB.js";import"./rc-checkbox-BRpMJEil.js";import"./scroll-into-view-if-needed-Bq0bK-M8.js";import"./compute-scroll-into-view-Bl8rNFhg.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-collapse-hmPsNoeL.js";import"./rc-pagination-BZmko9yw.js";import"./rc-picker-xBIvIHBR.js";import"./rc-textarea-BUz5BhTH.js";import"./copy-to-clipboard-DiJ1KpRP.js";import"./toggle-selection-DGa8lynz.js";import"./@remix-run-Ci2Y9YYq.js";import"./matchmediaquery-CFR3Nc42.js";import"./css-mediaquery-DL3IrIfu.js";import"./hyphenate-style-name-HOLnhz8K.js";import"./shallow-equal-BQUY1Bas.js";import"./prop-types-BQUlPbeI.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./eventemitter3-DCmFwiHc.js";import"./gl-matrix-CprEA30_.js";import"./tslib-OBXMYbRD.js";import"./d3-array-atsD2wCJ.js";import"./internmap-BkD7Hj8s.js";import"./color-string-UpWxH4A7.js";import"./color-name-Dju3oUBS.js";import"./simple-swizzle-FKz8em3-.js";import"./is-arrayish-DyGeW-O8.js";import"./d3-shape-emAqGUXY.js";import"./d3-path-DKbKBQE1.js";import"./d3-hierarchy-BwT0BVLI.js";import"./d3-format-bxs9DvuO.js";import"./d3-scale-chromatic-Cuoj2_tT.js";import"./d3-interpolate-J9zUb3gp.js";import"./d3-color-Cgbb-s5P.js";import"./fecha-DFkiGBGG.js";import"./flru-DUL4jbEG.js";import"./pdfast-Ck3ddN0u.js";import"./d3-dsv-BptE8-Pl.js";import"./d3-geo-D_Sa4YuD.js";import"./d3-force-CuiMVA5-.js";import"./d3-timer-N3g7Zl0V.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-quadtree-CSANTnla.js";import"./leaflet.markercluster-Wy1b80Jj.js";import"./@lezer-Dm_RAUY8.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bs6eFhZE.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const me=De()(Ie(t=>({accessToken:"",setToken:a=>t(()=>({...a})),deleteToken:()=>t(()=>({accessToken:""}))}),{name:"authToken",storage:Ae(()=>localStorage)})),La=void 0,F=()=>me.getState().accessToken;N.defaults.baseURL=La;const Na=async t=>N.post("/v1/auth/register",t,{headers:{"Content-Type":"application/json"}}).then(a=>a.data),Ba=async t=>N.post("/v1/auth/login",t,{headers:{"Content-Type":"application/json"}}).then(a=>a.data),$a=async t=>N.patch("/v1/auth/change-pass",t,{headers:{"Content-Type":"application/json"}}).then(a=>{const{message:n}=a.data;return n}),Fa=async()=>N.get("/v1/auth/me",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ma=async()=>N.get("/v1/user/profile",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ra=async t=>N.patch("/v1/user/update",t,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{message:n}=a.data;return n}),qa=async t=>N.delete("/v1/user/delete",{headers:{Authorization:`Bearer ${F()}`},data:t}).then(a=>{const{message:n}=a.data;return n}),wt=async t=>N.post("/v1/place",t,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{message:n}=a.data;return n}),za=async(t,a)=>N.patch(`/v1/place/${t}/update`,a,{headers:{Authorization:`Bearer ${F()}`}}).then(n=>{const{message:i}=n.data;return i}),Ka=async()=>N.get("/v1/place",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),vt=async t=>N.get(`/v1/place/${t}/detail`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{data:n}=a.data;return n}),Ea=async()=>N.get("/v1/place/statistic/user",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ua=async t=>N.delete(`/v1/place/${t}/remove`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{message:n}=a.data;return n}),Oa=async()=>N.get("/v1/user",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),_a=async t=>N.get(`/v1/user/${t}/resume`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{data:n}=a.data;return n}),Ha=async t=>N.get(`/v1/user/${t}/detail`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{data:n}=a.data;return n}),Pt=async t=>N.get(`/v1/place/${t}/compare-list`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{data:n}=a.data;return n}),Dt=async()=>N.get("/v1/place/building-filter",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Wa=async()=>N.get("/v1/place/user-only",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ja=async()=>N.get("/v1/admin",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ga=async()=>N.get("/v1/admin/user-only",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Ya=async()=>N.get("/v1/place/statistic/admin",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Za=async()=>N.get("/v1/place/admin-control",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),Qa=async t=>N.delete(`/v1/admin/${t}/remove/place`,{headers:{Authorization:`Bearer ${F()}`}}).then(a=>{const{message:n}=a.data;return n}),Va=async()=>N.get("/v1/place/all-user",{headers:{Authorization:`Bearer ${F()}`}}).then(t=>{const{data:a}=t.data;return a}),se=De()(Ie(t=>({role:3,name:"",exp:0,setUser:a=>t(()=>({...a})),clearUser:()=>t(()=>({role:3,exp:0,name:""}))}),{name:"user",storage:Ae(()=>localStorage)})),Xa=()=>e.jsx(ce,{style:{minHeight:"100vh",justifyContent:"center"},children:e.jsx(Je,{style:{margin:"0 auto"},tip:"Memuat...",size:"large",children:e.jsx("div",{className:"content"})})}),{Sider:en}=ce,tn=()=>{const[t,a]=g.useState(!0),n=te({query:"(max-width: 992px)"}),i={position:"fixed",top:50,left:t?0:200,fontSize:20,zIndex:99,cursor:"pointer",color:"white",padding:"8px 12px 8px 10px",borderRadius:"0 5px 5px 0",backgroundColor:"#001529",transition:t?"left 0.2s ease":"left 0.23s ease"},o=()=>{a(!t)},s=n?{position:"fixed",height:"100vh",zIndex:100}:{},u=[{key:"1",icon:e.jsx(sa,{}),label:e.jsx(xe,{to:"/",children:"Beranda Anda"})},{key:"2",icon:e.jsx(ra,{}),label:e.jsx(xe,{to:"/statistic",children:"Statistik Data"})},{key:"3",icon:e.jsx(oa,{}),label:e.jsx(xe,{to:"/compare-map",children:"Bandingkan Tempat"})}];return e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{style:i,onClick:o,children:t?e.jsx(aa,{}):e.jsx(na,{})}),e.jsxs(en,{style:s,breakpoint:"lg",collapsedWidth:"0",collapsible:n,collapsed:n?t:!1,trigger:null,children:[e.jsx("div",{className:"demo-logo-vertical"}),e.jsx(Zt,{theme:"dark",mode:"inline",items:u.map(h=>({key:h.key,icon:h.icon,label:h.label}))})]})]})},It=t=>{switch(!0){case/Android/.test(t):return{mobile:!0,device:"Android"};case/iPhone/.test(t):return{mobile:!0,device:"iPhone"};case/Macintosh/.test(t):return{mobile:!1,device:"Macintosh"};case/Windows/.test(t):return{mobile:!1,device:"Windows"};case(/Linux/.test(t)&&!/Android/.test(t)):return{mobile:!1,device:"Linux"};default:return{mobile:!1,device:"Unknown Device Type"}}},J=t=>new Date(t).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Xe=()=>{const a=new Date().getHours();let n;switch(!0){case a<5:n="Kamu Tidak Tidur";break;case(a>=5&&a<10):n="Selamat Pagi";break;case(a>=10&&a<15):n="Selamat Siang";break;case(a>=15&&a<18):n="Selamat Sore";break;case(a>=18&&a<22):n="Selamat Malam";break;default:n="Pukul Berapa Ini"}return n};let Ce;const ie=()=>(Ce||(Ce=ya(void 0,{transports:["websocket"]}),Ce.connect()),Ce),ct=["red","blue","green","orange","purple"],At=t=>ct[t%ct.length],an=t=>{const a=t.target;a.setStyle({weight:4,color:"#f9844d"}),a.bringToFront()},nn=t=>{const a=t.target;a.setStyle(a.defaultOptions)},Lt=(t,a,n)=>{a.defaultOptions={...a.options},a.on({mouseover:an,mouseout:nn,click:i=>{n(i,t)}})},Nt=t=>{navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{A.info("Tautan berhasil disalin ke clipboard!")}).catch(a=>{A.error("Gagal menyalin tautan: ",a)}):A.error("Clipboard API tidak mendukung peramban versi ini.")},Bt=t=>{const a=lt(t).hsl(),n=a[0],i=a[1]*100,o=a[2]*100;if(i<30||o<30)return null;const s=Array.from({length:5},(x,y)=>{const j=(5-y)/5;return Math.min(92,o+j*(92-o))}),u=Array.from({length:4},(x,y)=>{const j=(y+1)/5;return Math.max(7,o-j*(o-7))});return[...s,o,...u].map(x=>lt.hsl(n,i/100,x/100).hex())},he=De()(Ie(t=>({uniqueCode:"",mobile:!1,device:"",type:"",setDevice:a=>t(()=>({...a})),clearDevice:()=>t(()=>({uniqueCode:"",mobile:!1,device:"",type:""}))}),{name:"device",storage:Ae(()=>localStorage)})),{Header:sn,Content:rn,Footer:on}=ce,{Text:dt}=D,ln=()=>{const t=ye(),a=ie(),n=G(),i=me(),o=se(),s=he(),u=ja(),h=o.name,x=Xe(),y=()=>{a.emit("logout-device",{uniqueCode:s.uniqueCode}),i.deleteToken(),o.clearUser(),s.clearDevice(),localStorage.clear(),t.clear(),setTimeout(()=>{a.removeAllListeners(),n("/auth",{replace:!0})},1e3)},{token:{colorBgContainer:j}}=Le.useToken();return e.jsxs(ce,{style:{minHeight:"100dvh"},children:[e.jsx(tn,{}),e.jsxs(ce,{style:{overflowY:"scroll"},children:[e.jsxs(sn,{style:{display:"flex",justifyContent:u.pathname!=="/"?"space-between":"flex-end",alignItems:"center",padding:0,background:j,position:"sticky",top:0,right:0,zIndex:11,boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},children:[u.pathname!=="/"&&e.jsxs(dt,{strong:!0,style:{margin:"0 16px"},children:[x,", ",h]}),e.jsx(C,{style:{marginRight:24},onClick:()=>y(),children:e.jsxs(B,{children:["Keluar",e.jsx(ia,{})]})})]}),e.jsx(rn,{style:{margin:"16px",padding:24,background:j,borderRadius:8},children:e.jsx(Pe,{})}),e.jsx(on,{style:{paddingTop:4,fontSize:"1rem",textAlign:"center"},children:e.jsx(dt,{children:"Created by Ijan"})})]})]})},cn=({data:t,loading:a})=>(g.useEffect(()=>{if(!t)return;const n=new Me({container:"type-statistic",autoFit:!0}),i=t==null?void 0:t.chartType.map(o=>({Jenis:o.buildingName,Jumlah:o.placeCount,color:o.color}));return n.interval().data(i).encode("x","Jenis").encode("y","Jumlah").encode("color","Jenis").style("minHeight",10).scale("color",{range:i.map(o=>o.color)}).animate("enter",{type:"scaleInY",duration:1e3}).animate("exit",{type:"scaleOutY",duration:2e3}),n.render(),()=>{n.destroy()}},[t]),e.jsx(Z,{style:{marginTop:"1rem"},loading:a,active:!0,children:e.jsx("div",{id:"type-statistic"})})),dn=({data:t,loading:a})=>(g.useEffect(()=>{if(!t)return;const n=new Me({container:"create-statistic",autoFit:!0}),i=t==null?void 0:t.chartCreate.map(s=>({Jenis:s.buildingName,Jumlah:s.placeCount,Bulan:s.month,color:s.color})),o=[...new Set(i.map(s=>s.color))];return n.line().data(i).encode("x","Bulan").encode("y","Jumlah").encode("color","Jenis").scale("color",{range:o}).style("minHeight",10).animate("enter",{type:"pathIn",duration:1e3}),n.render(),()=>{n.destroy()}},[t]),e.jsx(Z,{style:{marginTop:"1rem"},loading:a,active:!0,children:e.jsx("div",{id:"create-statistic"})})),un=({data:t,loading:a})=>e.jsx(Z,{style:{marginTop:"1rem"},loading:a,active:!0,children:e.jsxs(ue,{center:[-1.2480891,118],zoom:5,scrollWheelZoom:!0,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(fa,{chuckedLoading:!0,children:t==null?void 0:t.chartArea.map((n,i)=>e.jsx(bt,{position:[n.placeCenterLong,n.placeCenterLat],children:e.jsx(ba,{children:n.placeName})},i))}),e.jsx(Ta,{position:"bottomleft"})]})}),pn=({data:t,loading:a})=>(g.useEffect(()=>{if(!t)return;const n=new Me({container:"update-statistic",autoFit:!0}),i=t==null?void 0:t.chartUpdate.map(s=>({Jenis:s.buildingName,Jumlah:s.placeCount,Bulan:s.month,color:s.color})),o=[...new Set(i.map(s=>s.color))];return n.line().data(i).encode("x","Bulan").encode("y","Jumlah").encode("color","Jenis").scale("color",{range:o}).style("minHeight",10).animate("enter",{type:"pathIn",duration:1e3}),n.render(),()=>{n.destroy()}},[t]),e.jsx(Z,{style:{marginTop:"1rem"},loading:a,active:!0,children:e.jsx("div",{id:"update-statistic"})})),{Title:mn}=D,hn=()=>{const t=G(),a=Xe(),i=se().name,o=[e.jsx($,{title:"Info Jenis Tempat",children:e.jsx(la,{onClick:()=>t("/place-type-action")},"list-building")}),e.jsx($,{title:"Info Lokasi Tempat",children:e.jsx(ca,{onClick:()=>t("/place-action")},"list-place")}),e.jsx($,{title:"Info Pengguna",children:e.jsx(da,{onClick:()=>t("/user-action")},"list-user")})],{data:s,isLoading:u}=O({queryKey:["place-statistic-admin"],queryFn:async()=>await Ya()}),h=[{key:"1",children:e.jsx(dn,{data:s,loading:u}),label:"Grafik Penambahan Data"},{key:"2",children:e.jsx(pn,{data:s,loading:u}),label:"Grafik Perubahan Data"}],x=[{key:"1",children:e.jsx(cn,{data:s,loading:u}),label:"Grafik Data Tempat Keseluruhan"}];return e.jsxs("div",{style:{minHeight:"100dvh"},children:[e.jsxs(V,{actions:o,style:{marginBottom:"1rem",maxWidth:"fit-content"},children:[e.jsxs(mn,{level:3,children:[a,", ",i]}),e.jsxs(z,{gap:30,style:{marginTop:"8px"},wrap:!0,children:[e.jsx(ge,{title:"Total Tempat",value:s==null?void 0:s.totalPlace}),e.jsx(ge,{title:"Baru Ditambahkan Bulan Ini",value:s==null?void 0:s.totalPlaceThisMonth}),e.jsx(ge,{title:"Persentase Perubahan Data",value:parseFloat(s==null?void 0:s.percentageComparison),precision:2,suffix:"%",valueStyle:{color:(s==null?void 0:s.statusPercentage)==="increase"?"green":(s==null?void 0:s.statusPercentage)==="decrease"?"red":"black"}})]})]}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,items:h.map(y=>({key:y.key,children:y.children,label:y.label}))})}),e.jsx(E,{xs:24,md:12,children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,items:x.map(y=>({key:y.key,children:y.children,label:y.label}))})})]}),e.jsx(un,{data:s,loading:u})]})},et=De()(Ie(t=>({id:"",desktop:"",uniqueCode:"",client:"",type:"",mobile:!1,setSocket:a=>t(()=>({...a})),clearSocket:()=>t(()=>({id:"",desktop:"",uniqueCode:"",client:"",type:"",mobile:!1}))}),{name:"socketData",storage:Ae(()=>localStorage)})),K=({description:t})=>e.jsx(it,{image:it.PRESENTED_IMAGE_SIMPLE,description:t}),{Link:gn}=D,xn=({state:t,setState:a,listDevice:n,deleteClient:i,rejectClient:o})=>{const s=ie(),[u,h]=g.useState([]),[x,y]=g.useState(!1),j=se(),k=he(),c=te({query:"(min-width: 640px)"});g.useEffect(()=>{const p=l=>{console.log(l),l.id===j.name&&l.desktop===k.device&&h(r=>r.some(S=>S.uniqueCode===l.uniqueCode&&S.client===l.client)?r:[...r,l])};return s.on(n,p),()=>{s.off(n,p)}},[k.device,s,j.name]),g.useEffect(()=>{const p=l=>{console.log(l),h(r=>r.filter(m=>m.uniqueCode!==l.uniqueCode))};s.on(i,p)},[s]),g.useEffect(()=>{const p=l=>{console.log(l.data),u.some(m=>(console.log(m.client),m.client===l.data))&&y(!1)};s.on(o,p)},[u,s]),console.log(u);const d=[{title:"Kode Perangkat",dataIndex:"uniqueCode",key:"client-code"},{title:"User Agent",dataIndex:"client",key:"client-user-agent"},{title:"Jenis Perangkat",dataIndex:"type",key:"client-type"},{title:"Aksi",key:"desktop-action",align:"center",width:"150px",render:(p,{uniqueCode:l,id:r,desktop:m,client:S,mobile:L,type:M})=>e.jsx(gn,{disabled:x,onClick:()=>{const R={uniqueCode:l,id:r,desktop:m,client:S,mobile:L,type:M};console.log(R),s.emit("client",R),y(!0)},children:"Pilih Perangkat"})}];if(c)return e.jsx(je,{title:"Daftar Perangkat Seluler Tertaut",open:t,centered:!0,maskClosable:!1,footer:[e.jsx(C,{onClick:()=>{s.emit("search-client",{id:j.name,desktop:k.device})},children:"Cari Perangkat Lain"},"refresh")],onCancel:()=>{h([]),a(!1)},width:700,children:e.jsx(W,{style:{height:u.length===0?"auto":"450px"},columns:d,dataSource:u,pagination:{defaultPageSize:2,position:["topRight"]},rowKey:({uniqueCode:p})=>p,locale:{emptyText:e.jsx(K,{description:"Perangkat Client Tidak Ditemukan"})}})})},{Text:yn}=D,jn=({title:t,okText:a,cancelText:n,onOk:i,onCancel:o,open:s,taskType:u})=>e.jsx(je,{title:t,open:s,centered:!0,closable:!1,maskClosable:!1,okText:a,cancelText:n,onCancel:o,onOk:i,children:e.jsxs(yn,{children:["Perangkat ini dipilih sebagai media untuk ",u," titik koordinat tempat. ",e.jsx("br",{})," Silahkan Tekan Setujui apabila menyetujuinya"]})}),{Title:kn,Text:ut}=D,fn=()=>{const t=G(),[a,n]=g.useState(!1),[i,o]=g.useState(!1),[s,u]=g.useState(),h=Xe(),x=ie(),y=se(),j=he(),k=et(),c=y.name,d=j.uniqueCode,p=j.mobile,l=[e.jsx($,{title:"Tambah Lokasi Manual",children:e.jsx(ua,{onClick:()=>t("/location/new/manual")},"manual")}),e.jsx($,{title:"Buat Koneksi",children:e.jsx(pa,{onClick:()=>{x.emit("search-client",{id:y.name,desktop:j.device}),n(!0)}},"connect")}),e.jsx($,{title:"Profil",children:e.jsx($e,{onClick:()=>t("/profile")},"profile")})],r=te({query:"(min-width: 640px)"}),{data:m,isLoading:S}=O({queryKey:["place-statistic-user"],queryFn:async()=>await Ea()});g.useEffect(()=>{if(!m)return;const I=new Me({container:"statistic",autoFit:!0}),P=m==null?void 0:m.detail.map(Y=>({Jenis:Y.buildingName,Jumlah:Y.placeCount,color:Y.color}));return I.interval().data(P).encode("x","Jenis").encode("y","Jumlah").encode("color","Jenis").style("minHeight",10).scale("color",{range:P.map(Y=>Y.color)}).animate("enter",{type:"scaleInY",duration:1e3}).animate("exit",{type:"scaleOutY",duration:2e3}),I.render(),()=>{I.destroy()}},[m]),g.useEffect(()=>{const I=P=>{console.log(P),P.id===y.name&&P.desktop!==j.device&&p&&(console.log(j),x.emit("set-list",{id:P.id,desktop:P.desktop,uniqueCode:d,client:j.device,type:j.type,mobile:j.mobile}))};return x.on("get-client",I),()=>{x.off("get-client",I)}},[j,p,x,d,y.name]),g.useEffect(()=>{const I=P=>{console.log(P),P.id===y.name&&P.client===j.device&&P.uniqueCode===j.uniqueCode&&P.mobile&&p&&(u(P),o(!0))};return x.on("choosen-client",I),()=>{x.off("choosen-client",I)}},[j.device,j.type,j.uniqueCode,p,s,x,y.name]),g.useEffect(()=>{const I=P=>{console.log(P),P.client===j.device&&P.uniqueCode===j.uniqueCode&&(k.setSocket(P),t("/location/new/client")),P.desktop===j.device&&(k.setSocket(P),t("/location/new/desktop"))};return x.on("accept-client",I),()=>{x.off("accept-client",I)}},[j.device,j.uniqueCode,t,x,k]);const L=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name"},{title:"Tipe",dataIndex:"placeType",key:"place-type",render:(I,{placeType:P})=>e.jsx(Q,{style:{margin:"0"},color:P.label,children:P.name.toUpperCase()})},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"place-create",align:"center",responsive:["sm"],render:(I,{createdAt:P})=>e.jsx("p",{children:J(P)})}],M=()=>{x.emit("reject-choice",{data:s==null?void 0:s.client}),o(!1)},R=()=>{x.emit("accept-choice",s),o(!1)};return e.jsxs("div",{style:{minHeight:"100dvh"},children:[a&&e.jsx(xn,{state:a,setState:n,listDevice:"list-client-create",rejectClient:"reject-client-create",deleteClient:"delete-client-create"}),i&&p&&(s==null?void 0:s.id)===y.name&&(s==null?void 0:s.client)===j.device&&e.jsx(jn,{title:"Konfirmasi Penerimaan Tugas",open:i,okText:"Setuju",cancelText:"Tolak",onCancel:M,onOk:R,taskType:"memasukkan"}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsxs(E,{xs:24,md:12,children:[e.jsxs(V,{actions:r&&!p?l:void 0,children:[e.jsxs(kn,{level:3,children:[h,", ",c]}),e.jsxs(ut,{children:["Kode Perangkat Tertaut: ",e.jsx("b",{children:d})]}),e.jsxs(z,{gap:30,style:{marginTop:"8px"},wrap:!0,children:[e.jsx(ge,{title:"Total Tempat",value:m==null?void 0:m.totalPlace}),e.jsx(ge,{title:"Baru Ditambahkan Bulan Ini",value:m==null?void 0:m.totalPlaceThisMonth})]})]}),e.jsx(Z,{style:{marginTop:"1rem"},loading:S,active:!0,children:e.jsx("div",{id:"statistic"})})]}),e.jsx(E,{xs:24,md:12,children:e.jsx(z,{vertical:!0,gap:"large",children:e.jsxs("div",{children:[e.jsx(ut,{strong:!0,style:{fontSize:"1rem"},children:"Data 10 Tempat Terbaru"}),e.jsx(W,{style:{maxHeight:"700px",width:"100%",marginTop:"0.7rem"},pagination:!1,loading:S,columns:L,dataSource:m==null?void 0:m.newPlace,rowKey:({placeId:I})=>I,locale:{emptyText:e.jsx(K,{description:"Belum Ada Tempat Baru Yang Ditambahkan"})}})]})})})]})]})},bn=()=>se().role===3?e.jsx(fn,{}):e.jsx(hn,{}),{Title:Tn}=D,Cn=()=>{const{token:{colorBgContainer:t}}=Le.useToken(),a=g.useRef(null),{mutate:n}=X({mutationFn:$a,onSuccess:o=>{var s;(s=a.current)==null||s.resetFields(),A.open({type:"success",content:o,duration:3})},onError:o=>{o.response.data.message.map(s=>{A.open({type:"error",content:s,duration:5})})}}),i=o=>{n(o)};return e.jsxs(b,{name:"normal_forget",className:"forget-form",style:{maxWidth:"400px",width:"100%",margin:"0 auto",padding:"16px",borderRadius:"8px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.05)",background:t},ref:o=>{a.current=o},onFinish:i,children:[e.jsx(Tn,{level:4,style:{paddingBottom:16},children:"Lupa Kata Sandi"}),e.jsx(b.Item,{name:"username",rules:[{required:!0,message:"Silahkan Masukkan Nama Pengguna!"}],style:{maxWidth:400},children:e.jsx(w,{prefix:e.jsx($e,{className:"site-form-item-icon"}),placeholder:"Username",autoComplete:"off"})}),e.jsx(b.Item,{name:"newpass",rules:[{required:!0,message:"Harap Masukkan Kata Sandi Baru!"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/,message:"Kata sandi harus mengandung huruf kapital, huruf kecil, dan angka"}],style:{maxWidth:400},children:e.jsx(w.Password,{prefix:e.jsx(Fe,{className:"site-form-item-icon"}),placeholder:"Kata Sandi Baru",autoComplete:"off",iconRender:o=>o?e.jsx(He,{}):e.jsx(We,{})})}),e.jsx(b.Item,{name:"verify",rules:[{required:!0,message:"Verifikasi Kata Sandi Baru Anda"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/,message:"Kata sandi harus mengandung huruf kapital, huruf kecil, dan angka"}],style:{maxWidth:400},children:e.jsx(w,{prefix:e.jsx(gt,{className:"site-form-item-icon"}),type:"password",placeholder:"Verifikasi Kata Sandi Baru",autoComplete:"off"})}),e.jsx(b.Item,{label:"Kode Ajaib",name:"code",tooltip:"Gunakan Kode Yang Telah Anda Buat",rules:[{required:!0,message:"Masukkan Kode Keamanan Anda!"}],style:{maxWidth:400},children:e.jsx(w,{prefix:e.jsx(xt,{className:"site-form-item-icon"}),type:"password",placeholder:"Masukkan Kode Ajaib",autoComplete:"off"})}),e.jsx(b.Item,{style:{marginBottom:8},children:e.jsx(C,{style:{width:"100%",marginBottom:8},type:"primary",htmlType:"submit",className:"forget-form-button",children:"Ubah Kata Sandi"})})]})},{Title:Sn}=D,wn=()=>{const t=me(),a=he(),{token:{colorBgContainer:n}}=Le.useToken(),i=navigator.userAgent,o=It(i),s=St("1234567890ABCDEFGHIJ",10),{mutate:u}=X({mutationFn:Ba,onSuccess:x=>{t.setToken({accessToken:x.accessToken}),a.setDevice({uniqueCode:s(5),device:i,type:o.device,mobile:o.mobile}),A.open({type:"success",content:x.message,duration:3})},onError:x=>{A.open({type:"error",content:x.response.data.message,duration:5})}}),h=x=>{const y=Ct.AES.encrypt(x.password,void 0).toString();u({username:x.username,password:void 0+y})};return t.accessToken?e.jsx(Qe,{to:"/",replace:!0}):e.jsxs(b,{name:"normal_login",className:"login-form",style:{maxWidth:"400px",width:"100%",margin:"0 auto",padding:"16px",borderRadius:"8px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.05)",background:n},onFinish:h,children:[e.jsx(Sn,{level:4,style:{paddingBottom:16},children:"Masuk"}),e.jsx(b.Item,{name:"username",rules:[{required:!0,message:"Tolong Masukan Nama Pengguna!"}],style:{maxWidth:400},children:e.jsx(w,{prefix:e.jsx($e,{className:"site-form-item-icon"}),placeholder:"Nama Pengguna",autoComplete:"off"})}),e.jsx(b.Item,{name:"password",rules:[{required:!0,message:"Tolong Masukan Kata Sandi!"}],style:{maxWidth:400},children:e.jsx(w,{prefix:e.jsx(Fe,{className:"site-form-item-icon"}),type:"password",placeholder:"Kata Sandi",autoComplete:"off"})}),e.jsx(b.Item,{style:{marginBottom:8},children:e.jsx(C,{style:{width:"100%",marginBottom:8},type:"primary",htmlType:"submit",className:"login-form-button",children:"Masuk"})})]})},{Title:vn}=D,Pn=()=>{const t=me(),a=he(),{token:{colorBgContainer:n}}=Le.useToken(),i=g.useRef(null),o=navigator.userAgent,s=It(o),u=St("1234567890ABCDEFGHIJ",10),{mutate:h}=X({mutationFn:Na,onSuccess:y=>{var j;t.setToken({accessToken:y.accessToken}),a.setDevice({uniqueCode:u(5),device:o,type:s.device,mobile:s.mobile}),(j=i.current)==null||j.resetFields(),A.open({type:"success",content:y.message,duration:3})},onError:y=>{y.response.data.message.map(j=>{A.open({type:"error",content:j,duration:5})})}}),x=y=>{const j=Ct.AES.encrypt(y.password,void 0).toString();h({username:y.username,fullname:y.fullname,password:void 0+j,verify:y.verify,code:y.code})};return t.accessToken?e.jsx(Qe,{to:"/",replace:!0}):e.jsxs(b,{name:"normal_regist",className:"regist-form",style:{maxWidth:"400px",width:"100%",margin:"0 auto",padding:"16px",borderRadius:"8px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.05)",background:n},ref:y=>{i.current=y},onFinish:x,children:[e.jsx(vn,{level:4,style:{paddingBottom:16},children:"Buat Akun"}),e.jsx(b.Item,{name:"fullname",rules:[{required:!0,message:"Masukan Nama Lengkap Anda!"}],style:{maxWidth:400},children:e.jsx(w,{count:{show:!0,max:30},prefix:e.jsx(ma,{className:"site-form-item-icon"}),placeholder:"Nama Lengkap",autoComplete:"off"})}),e.jsx(b.Item,{name:"username",rules:[{required:!0,message:"Masukan Nama Pengguna!"}],style:{maxWidth:400},children:e.jsx(w,{count:{show:!0,max:8},prefix:e.jsx($e,{className:"site-form-item-icon"}),placeholder:"Nama Pengguna",autoComplete:"off"})}),e.jsx(b.Item,{name:"password",rules:[{required:!0,message:"Masukan Kata Sandi!"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/,message:"Kata sandi harus mengandung huruf kapital, huruf kecil, dan angka"}],style:{maxWidth:400},children:e.jsx(w.Password,{prefix:e.jsx(Fe,{className:"site-form-item-icon"}),placeholder:"Kata Sandi",autoComplete:"off",iconRender:y=>y?e.jsx(He,{}):e.jsx(We,{})})}),e.jsx(b.Item,{name:"verify",rules:[{required:!0,message:"Verifikasi Kata Sandi!"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/,message:"Kata sandi harus mengandung huruf kapital, huruf kecil, dan angka"}],style:{maxWidth:400},children:e.jsx(w.Password,{prefix:e.jsx(gt,{className:"site-form-item-icon"}),placeholder:"Verifikasi Kata Sandi",autoComplete:"off"})}),e.jsx(b.Item,{label:"Kode Ajaib",name:"code",tooltip:"Gunakan Kode Khusus Untuk Merubah Kata Sandi",extra:"Ingat Kode Anda Dengan Baik",rules:[{required:!0,message:"Masukkan Kode Ajaib Anda!"},{pattern:/^[0-9]{6}$/,message:"Masukkan Kode Berupa 6 Angka"}],style:{maxWidth:400},children:e.jsx(w.Password,{count:{show:!0,max:6},prefix:e.jsx(xt,{className:"site-form-item-icon"}),placeholder:"Masukkan Kode Ajaib",autoComplete:"off",iconRender:y=>y?e.jsx(He,{}):e.jsx(We,{})})}),e.jsx(b.Item,{style:{marginBottom:8},children:e.jsx(C,{style:{width:"100%",marginBottom:8},type:"primary",htmlType:"submit",className:"regist-form-button",children:"Buat Akun"})})]})},Dn=()=>{const t=[{key:"1",children:e.jsx(wn,{}),label:e.jsx($,{title:"Masuk Ke Laman",children:e.jsx(ha,{style:{margin:"0 auto"}})})},{key:"2",children:e.jsx(Pn,{}),label:e.jsx($,{title:"Daftar Sebagai Pengguna",children:e.jsx(ga,{style:{margin:"0 auto"}})})},{key:"3",children:e.jsx(Cn,{}),label:e.jsx($,{title:"Atur Ulang Sandi",children:e.jsx(xa,{style:{margin:"0 auto"}})})}];return e.jsx(ce,{style:{minHeight:"100vh",justifyContent:"center"},children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,style:{marginInline:"1rem"},items:t.map(a=>({key:a.key,children:a.children,label:a.label}))})})},tt=({title:t,buttonTitle:a})=>{const n=G();return e.jsx(de,{items:[{onClick:()=>n(-1),title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:a})},{title:t}],style:{marginBottom:"1rem"}})},In=({state:t,setState:a,initialValue:n})=>{const[i]=b.useForm(),o=ye(),{mutate:s}=X({mutationFn:Ra,onSuccess:y=>{o.invalidateQueries({queryKey:["my-profile"]}),a(!1),A.open({type:"success",content:y,duration:3})},onError:y=>{A.open({type:"error",content:y.response.data.message,duration:5})}}),u=()=>{a(!1),i.resetFields()},h=y=>{const j=Object.fromEntries(Object.entries(y).filter(([k,c])=>c!==n[k]));if(Object.keys(j).length===0){A.info("Tidak ada perubahan data");return}s(j)},x=()=>{i.submit()};return e.jsx(je,{title:"Ubah Data Profil",open:t,centered:!0,maskClosable:!1,cancelText:"Batalkan",okText:"Perbarui Data",onCancel:u,onOk:x,children:e.jsxs(b,{form:i,name:"edit_profil",onFinish:h,initialValues:n,layout:"vertical",children:[e.jsx(b.Item,{name:"username",label:"Nama Panggilan",children:e.jsx(w,{placeholder:"Masukkan Nama Panggilan"})}),e.jsx(b.Item,{name:"fullname",label:"Nama Lengkap",children:e.jsx(w,{placeholder:"Masukkan Nama Lengkap"})}),e.jsx(b.Item,{name:"description",label:"Keterangan Akun",children:e.jsx(w,{placeholder:"Deskripsikan Akun Ini"})})]})})},$t=({placeId:t,placeCenterPoint:a,placeMap:n,color:i})=>e.jsxs(ue,{center:a,zoom:20,scrollWheelZoom:!1,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n&&e.jsx(Te,{data:n==null?void 0:n.placeGeojson,style:{color:i}},`detil-map-${t}`)]}),Ft=({data:t,loading:a,action:n})=>{const i=ye(),o=G(),{mutate:s}=X({mutationFn:Ua,onSuccess:r=>{i.invalidateQueries({queryKey:["my-profile"]}),A.open({type:"success",content:r,duration:3})},onError:r=>{A.open({type:"error",content:r.response.data.message,duration:5})}}),[u,h]=g.useState(""),[x,y]=g.useState(""),j=g.useRef(null),k=(r,m,S)=>{m({closeDropdown:!0}),h(r[0]),y(S)},c=r=>{r(),h("")},d=r=>({filterDropdown:({setSelectedKeys:m,selectedKeys:S,confirm:L,clearFilters:M,close:R})=>e.jsxs("div",{style:{padding:8},onKeyDown:I=>I.stopPropagation(),children:[e.jsx(w,{ref:j,placeholder:`Search ${r}`,value:S[0],onChange:I=>m(I.target.value?[I.target.value]:[]),onPressEnter:()=>k(S,L,r),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>k(S,L,r),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{M&&c(M),L({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{R()},children:"Tutup"})]})]}),filterIcon:m=>e.jsx(H,{style:{color:m?"#1677ff":void 0}}),onFilter:(m,S)=>S[r].toString().toLowerCase().includes(m.toLowerCase()),render:m=>x===r?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[u],autoEscape:!0,textToHighlight:m?m.toString():""}):m}),p=r=>{s(r)},l=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name",...d("placeName")},{title:"Tipe",dataIndex:"type",key:"place-type",width:n?"150px":"250px",responsive:["sm"],render:(r,{type:m})=>e.jsx(Q,{style:{margin:"0"},color:m.label,children:m.name.toUpperCase()})}];return n&&l.push({title:"Aksi",key:"place-action",align:"center",width:"150px",render:(r,{placeId:m})=>e.jsxs(B,{size:"middle",children:[e.jsx($,{title:"Ubah Data Tempat",placement:"bottom",children:e.jsx(C,{type:"primary",onClick:()=>o(`/location/update/manual/${m}`),children:e.jsx(yt,{})})}),e.jsx(Ne,{placement:"left",title:"Yakin nih mau dihapus?",description:"Semua data terkait tempat ini akan hilang",onConfirm:()=>p(m),okText:"Yakin",cancelText:"Tidak Dulu",children:e.jsx(C,{danger:!0,children:e.jsx(be,{})})})]})}),e.jsx(W,{size:"small",sticky:!0,style:{backgroundColor:"transparent"},loading:a,columns:l,dataSource:t,rowKey:({placeId:r})=>r,locale:{emptyText:e.jsx(K,{description:"Anda Belum Menambahkan Data Tempat"})},expandable:{expandedRowRender:({placeId:r,placeOwner:m,placeDescription:S,placeMap:L,placeCenterPoint:M,placeAddress:R,type:I,createdAt:P,updatedAt:Y})=>e.jsxs("div",{style:{paddingInline:"8px",paddingBottom:"8px"},children:[e.jsx(ke,{size:"small",style:{marginBottom:"1em"},title:"Info Tempat",items:[{key:"1",label:"Ditambahkan Pada",children:J(P)},{key:"2",label:"Diperbarui Pada",children:J(Y)},{key:"3",label:"Pemilik Tempat",children:m||"-"},{key:"4",label:"Alamat Tempat",children:R},{key:"5",label:"Penjelasan Tempat",children:S||"-"}]}),e.jsx($t,{placeCenterPoint:M,placeId:r,color:I.color,placeMap:L})]})}})},{Text:Mt}=D,Rt=({avatar:t})=>e.jsx(Qt,{size:48,style:{backgroundColor:"#1677ff"},children:t}),qt=({fullname:t,username:a,copy:n})=>e.jsx(Mt,{style:{fontSize:"1rem"},strong:!0,copyable:n?{text:`${a}`,tooltips:["Salin Username","Username Berhasil Disalin"]}:void 0,children:t}),zt=({loginAt:t})=>e.jsxs(Mt,{children:["Terakhir masuk"," ",Sa(wa(t),{addSuffix:!0,locale:va})]}),Kt=({createdAt:t,admin:a,description:n})=>{const i=[{key:"1",label:"Dibuat Pada",children:J(t)},{key:"2",label:"Status Akun",children:a?"Pengelola":"Pengguna"},{key:"3",label:"Deskripsi Akun",children:n||"-"}];return e.jsx(ke,{size:"small",items:i})},An=({setEdit:t,setDelete:a,myId:n})=>{const i=()=>{const o=window.location.href,s=o.substring(0,o.lastIndexOf("/")+1);Nt(`${s}statistic/user/${n}`)};return e.jsxs(B.Compact,{block:!0,children:[e.jsx($,{title:"Perbarui Profil",children:e.jsx(C,{className:"icon-profile",icon:e.jsx(yt,{}),onClick:()=>t(!0)})}),e.jsx($,{title:"Bagikan Profil",children:e.jsx(C,{className:"icon-profile",icon:e.jsx(jt,{}),onClick:()=>i()})}),e.jsx($,{title:"Hapus Profil",children:e.jsx(C,{className:"icon-profile-danger",icon:e.jsx(be,{}),onClick:()=>a(!0)})})]})},{Text:Ln}=D,Nn=({setState:t,state:a})=>{const[n]=b.useForm(),i=ye(),o=ie(),s=G(),u=me(),h=se(),x=he(),{mutate:y}=X({mutationFn:qa,onSuccess:d=>{o.emit("logout-device",{uniqueCode:x.uniqueCode}),u.deleteToken(),h.clearUser(),x.clearDevice(),localStorage.clear(),i.clear(),A.open({type:"success",content:d,duration:3}),setTimeout(()=>{o.removeAllListeners(),s("/auth",{replace:!0})},1e3)},onError:d=>{A.open({type:"error",content:d.response.data.message,duration:5})}}),j=()=>{t(!1),n.resetFields()},k=d=>{y(d)},c=()=>{n.submit()};return e.jsxs(je,{title:"Hapus Seluruh Data",open:a,centered:!0,width:300,maskClosable:!1,cancelText:"Batalkan",okText:"Hapus Akun",onCancel:j,onOk:c,children:[e.jsx(Ln,{children:"Info Info"}),e.jsx(b,{form:n,name:"delete_profil",onFinish:k,layout:"vertical",children:e.jsx(b.Item,{name:"password",label:"Kata Sandi",children:e.jsx(w,{type:"password",placeholder:"Masukan Sandi Anda"})})})]})},Bn=()=>{const[t,a]=g.useState(!1),[n,i]=g.useState(!1),o=te({query:"(max-width: 600px)"}),{data:s,isLoading:u}=O({queryKey:["my-profile"],queryFn:async()=>await Ma()});return e.jsxs(e.Fragment,{children:[t&&e.jsx(In,{state:t,setState:a,initialValue:{username:s==null?void 0:s.userName,fullname:s==null?void 0:s.fullName,description:s==null?void 0:s.description}}),n&&e.jsx(Nn,{state:n,setState:i}),e.jsx(tt,{title:"Profil Pengguna",buttonTitle:"Kembali"}),e.jsxs(z,{gap:"middle",vertical:!0,children:[e.jsx(Z,{loading:u,active:!0,avatar:!0,paragraph:{rows:2},children:e.jsxs(B,{direction:o?"vertical":"horizontal",children:[e.jsx(Rt,{avatar:s==null?void 0:s.avatar}),e.jsxs(z,{vertical:!0,children:[e.jsxs(ee,{children:[e.jsx(E,{flex:"auto",children:e.jsx(qt,{fullname:s==null?void 0:s.fullName,username:s==null?void 0:s.userName,copy:!1})}),e.jsx(E,{flex:"none",children:e.jsx(An,{setEdit:a,setDelete:i,myId:s==null?void 0:s.me})})]}),s&&e.jsx(zt,{loginAt:s==null?void 0:s.loginAt}),e.jsx(Kt,{createdAt:s==null?void 0:s.createdAt,admin:s==null?void 0:s.admin,description:s==null?void 0:s.description})]})]})}),e.jsx(Ft,{data:s==null?void 0:s.place,loading:u,action:!0})]})]})},$n=()=>{const{data:t,isLoading:a}=O({queryKey:["user-all-admin"],queryFn:async()=>await Ja()}),[n,i]=g.useState(""),[o,s]=g.useState(""),u=g.useRef(null),h=(k,c,d)=>{c({closeDropdown:!0}),i(k[0]),s(d)},x=k=>{k(),i("")},j=[{title:"Nama Pengguna",dataIndex:"userName",key:"user-name",...(k=>({filterDropdown:({setSelectedKeys:c,selectedKeys:d,confirm:p,clearFilters:l,close:r})=>e.jsxs("div",{style:{padding:8},onKeyDown:m=>m.stopPropagation(),children:[e.jsx(w,{ref:u,placeholder:`Search ${k}`,value:d[0],onChange:m=>c(m.target.value?[m.target.value]:[]),onPressEnter:()=>h(d,p,k),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>h(d,p,k),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{l&&x(l),p({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{r()},children:"Tutup"})]})]}),filterIcon:c=>e.jsx(H,{style:{color:c?"#1677ff":void 0}}),onFilter:(c,d)=>d[k].toString().toLowerCase().includes(c.toLowerCase()),render:c=>o===k?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:c?c.toString():""}):c}))("userName")},{title:"Deskripsi Pengguna",dataIndex:"description",key:"user-desc",responsive:["lg"]},{title:"Tipe",dataIndex:"userType",key:"user-type",align:"center",width:"150px",responsive:["sm"],render:(k,c)=>{const d=c.role.label,p=c.role.roleName;return e.jsx(Q,{color:d,children:p.toUpperCase()})}},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"user-create",align:"center",sorter:(k,c)=>new Date(c.createdAt).getTime()-new Date(k.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",responsive:["md"],render:(k,c)=>{const d=J(c.createdAt);return e.jsx("p",{children:d})}},{title:"Aksi",key:"admin-action",width:"150px",align:"center",render:(k,c)=>{if(c.role.roleName==="User")return e.jsx(xe,{to:`/statistic/user/${c.userId}`,children:"Lihat Pengguna"})}}];return e.jsx(W,{sticky:!0,style:{backgroundColor:"transparent"},loading:a,columns:j,dataSource:t,rowKey:({userId:k})=>k,locale:{emptyText:e.jsx(K,{description:"Data Pengguna Kosong"})}})},Fn=()=>{const{data:t,isLoading:a}=O({queryKey:["place-all"],queryFn:async()=>await Ka()}),[n,i]=g.useState(""),[o,s]=g.useState(""),u=g.useRef(null),h=(k,c,d)=>{c({closeDropdown:!0}),i(k[0]),s(d)},x=k=>{k(),i("")},j=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name",...(k=>({filterDropdown:({setSelectedKeys:c,selectedKeys:d,confirm:p,clearFilters:l,close:r})=>e.jsxs("div",{style:{padding:8},onKeyDown:m=>m.stopPropagation(),children:[e.jsx(w,{ref:u,placeholder:`Search ${k}`,value:d[0],onChange:m=>c(m.target.value?[m.target.value]:[]),onPressEnter:()=>h(d,p,k),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>h(d,p,k),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{l&&x(l),p({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{r()},children:"Tutup"})]})]}),filterIcon:c=>e.jsx(H,{style:{color:c?"#1677ff":void 0}}),onFilter:(c,d)=>d[k].toString().toLowerCase().includes(c.toLowerCase()),render:c=>o===k?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:c?c.toString():""}):c}))("placeName")},{title:"Alamat",dataIndex:"placeAddress",key:"place-address",responsive:["xl"]},{title:"Tipe",dataIndex:"placeType",key:"place-type",width:"150px",responsive:["sm"],render:(k,{type:c})=>e.jsx(Q,{style:{margin:"0"},color:c.label,children:c.name.toUpperCase()})},{title:"Oleh",dataIndex:"createdBy",key:"place-creator",align:"center",width:"150px",responsive:["md"]},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"place-create",align:"center",width:"150px",responsive:["md"],sorter:(k,c)=>new Date(c.createdAt).getTime()-new Date(k.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",render:(k,{createdAt:c})=>{const d=J(c);return e.jsx("p",{children:d})}},{title:"Aksi",key:"place-action",align:"center",width:"150px",render:(k,{placeId:c})=>e.jsx(xe,{to:`/statistic/place/${c}`,children:"Rincian"})}];return e.jsx(W,{sticky:!0,style:{backgroundColor:"transparent"},loading:a,columns:j,dataSource:t,rowKey:({placeId:k})=>k,locale:{emptyText:e.jsx(K,{description:"Data Tempat Kosong"})}})},Mn=({id:t,state:a,setState:n})=>{const i=G(),{data:o,isLoading:s}=O({queryKey:["user-mini-profile",t],queryFn:async()=>await _a(t)}),u=[{key:"1",label:"Dibuat Pada",children:J(o==null?void 0:o.createdAt)},{key:"2",label:"Nama Akun",children:o==null?void 0:o.userName},{key:"3",label:"Nama Pengguna",children:o==null?void 0:o.fullName},{key:"4",label:"Deskripsi Akun",children:o!=null&&o.description?o==null?void 0:o.description:"-"},{key:"5",label:"Jumlah Tempat",children:o==null?void 0:o.Count.place}];return e.jsx(je,{title:"Profil Singkat",open:a,maskClosable:!1,centered:!0,footer:()=>e.jsx(C,{type:"primary",onClick:()=>{i(`/statistic/user/${t}`),n(!1)},children:"Kunjungi Profil"}),onCancel:()=>{n(!1)},children:e.jsx(Z,{loading:s,paragraph:{rows:4},children:e.jsx(ke,{layout:"vertical",size:"small",items:u})})})},Rn=()=>{const[t,a]=g.useState(!1),[n,i]=g.useState(""),{data:o,isLoading:s}=O({queryKey:["user-all"],queryFn:async()=>await Oa()}),[u,h]=g.useState(""),[x,y]=g.useState(""),j=g.useRef(null),k=(l,r,m)=>{r({closeDropdown:!0}),h(l[0]),y(m)},c=l=>{l(),h("")},p=[{title:"Nama Pengguna",dataIndex:"userName",key:"user-name",...(l=>({filterDropdown:({setSelectedKeys:r,selectedKeys:m,confirm:S,clearFilters:L,close:M})=>e.jsxs("div",{style:{padding:8},onKeyDown:R=>R.stopPropagation(),children:[e.jsx(w,{ref:j,placeholder:`Search ${l}`,value:m[0],onChange:R=>r(R.target.value?[R.target.value]:[]),onPressEnter:()=>k(m,S,l),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>k(m,S,l),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{L&&c(L),S({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{M()},children:"Tutup"})]})]}),filterIcon:r=>e.jsx(H,{style:{color:r?"#1677ff":void 0}}),onFilter:(r,m)=>m[l].toString().toLowerCase().includes(r.toLowerCase()),render:r=>x===l?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[u],autoEscape:!0,textToHighlight:r?r.toString():""}):r}))("userName")},{title:"Deskripsi Pengguna",dataIndex:"description",key:"user-desc",responsive:["md"]},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"user-create",align:"center",sorter:(l,r)=>new Date(r.createdAt).getTime()-new Date(l.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",responsive:["sm"],render:(l,r)=>{const m=J(r.createdAt);return e.jsx("p",{children:m})}},{title:"Aksi",key:"user-action",width:"150px",align:"center",render:(l,{userId:r})=>e.jsx(C,{type:"link",onClick:()=>{i(r),a(!0)},children:"Rincian"})}];return e.jsxs(e.Fragment,{children:[t&&e.jsx(Mn,{id:n,state:t,setState:a}),e.jsx(W,{sticky:!0,style:{backgroundColor:"transparent"},loading:s,columns:p,dataSource:o,rowKey:({userId:l})=>l,locale:{emptyText:e.jsx(K,{description:"Data Pengguna Kosong"})}})]})},qn=()=>{const t=se().role,a=[{key:"1",children:e.jsx(Fn,{}),label:"Daftar Tempat"},{key:"2",children:t===3?e.jsx(Rn,{}):e.jsx($n,{}),label:"Daftar Pengguna"}];return e.jsx(ce,{style:{backgroundColor:"transparent"},children:e.jsx(oe,{defaultActiveKey:"1",items:a.map(n=>({key:n.key,children:n.children,label:n.label}))})})},at=({position:t})=>{const a=Tt();return g.useEffect(()=>{console.log("Position:",t),t&&t.length===2&&a.flyTo(t)},[t,a]),null},zn=({data:t,placeMap:a,position:n})=>e.jsxs(ue,{center:[-1.2480891,118],zoom:17,scrollWheelZoom:!1,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t&&(t==null?void 0:t.placeMap)&&e.jsx(at,{position:n}),a&&e.jsx(Te,{data:a,style:{color:t.type.color}},`detil-map-${t==null?void 0:t.placeId}`)]}),{Title:Kn}=D,En=()=>{const{id:t}=Ve(),{data:a,isPending:n,isLoading:i}=O({queryKey:["place-detail",t],queryFn:async()=>await vt(t)}),o=g.useMemo(()=>n?null:a==null?void 0:a.placeMap.placeGeojson,[a,n]);let s=null;if(a){const h=a==null?void 0:a.placeCenterPoint;h&&h.length===2&&(s=h)}const u=[{key:"1",label:"Terakhir Diperbarui",children:J(a==null?void 0:a.updatedAt)},{key:"2",label:"Dibuat Oleh",children:e.jsx("b",{children:a==null?void 0:a.createdBy})},{key:"3",label:"Alamat Tempat",children:a==null?void 0:a.placeAddress},{key:"4",label:"Pemilik Tempat",children:a!=null&&a.placeOwner?a==null?void 0:a.placeOwner:"Pemilik Tidak Diketahui"},{key:"5",label:"Keterangan",children:a!=null&&a.placeDescription?a==null?void 0:a.placeDescription:"Belum Ada Keterangan"}];return e.jsxs(e.Fragment,{children:[e.jsx(tt,{title:"Rincian Tempat",buttonTitle:"Kembali"}),e.jsxs(Z,{loading:i,active:!0,title:!0,paragraph:{rows:1},children:[e.jsx(Kn,{level:3,style:{textAlign:"center",marginBottom:"0"},children:a==null?void 0:a.placeName}),e.jsx(z,{justify:"center",align:"center",children:e.jsx(Q,{style:{marginTop:"4px"},color:a==null?void 0:a.type.label,children:a==null?void 0:a.type.name.toUpperCase()})})]}),e.jsxs(z,{gap:"middle",vertical:!1,style:{marginTop:"2rem"},wrap:!0,children:[e.jsx(zn,{data:a,placeMap:o,position:s}),e.jsx(Z,{loading:i,style:{width:"100%"},active:!0,children:e.jsx(ke,{style:{width:"100%"},column:1,bordered:!0,items:u})})]})]})},Un=()=>{const{id:t}=Ve(),a=te({query:"(max-width: 600px)"}),{data:n,isLoading:i}=O({queryKey:["user-profile",t],queryFn:async()=>await Ha(t)}),o=()=>{const s=window.location.href,u=s.substring(0,s.lastIndexOf("/")+1);Nt(`${u}${n==null?void 0:n.me}`)};return e.jsxs(e.Fragment,{children:[e.jsx(tt,{title:"Profil Pengguna",buttonTitle:"Kembali"}),e.jsxs(z,{gap:"middle",vertical:!0,children:[e.jsx(Z,{loading:i,active:!0,avatar:!0,paragraph:{rows:2},children:e.jsxs(B,{direction:a?"vertical":"horizontal",children:[e.jsx(Rt,{avatar:n==null?void 0:n.avatar}),e.jsxs(z,{vertical:!0,children:[e.jsxs(ee,{children:[e.jsx(E,{flex:"auto",children:e.jsx(qt,{fullname:n==null?void 0:n.fullName,username:n==null?void 0:n.userName,copy:!0})}),e.jsx(E,{flex:"none",children:e.jsx(B.Compact,{block:!0,children:e.jsx($,{title:"Bagikan Profil",children:e.jsx(C,{className:"icon-profile",icon:e.jsx(jt,{}),onClick:()=>o()})})})})]}),n&&e.jsx(zt,{loginAt:n==null?void 0:n.loginAt}),e.jsx(Kt,{createdAt:n==null?void 0:n.createdAt,admin:n==null?void 0:n.admin,description:n==null?void 0:n.description})]})]})}),e.jsx(Ft,{data:n==null?void 0:n.place,loading:i,action:!1})]})]})},{Text:On}=D,nt=({centerPoint:t,mapData:a})=>e.jsxs(e.Fragment,{children:[e.jsx(On,{children:"Tampilan Batas Tempat Pada Peta"}),e.jsxs(ue,{center:t,zoom:17,scrollWheelZoom:!1,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a&&e.jsx(Te,{data:a},`map-data-${new Date().getMilliseconds()}`)]})]}),{Text:_n}=D,st=({initialJson:t})=>{const a=JSON.stringify(t,null,2),[n,i]=g.useState(a);return g.useEffect(()=>{i(a)},[a]),e.jsxs(e.Fragment,{children:[e.jsx(_n,{children:"Format Data Yang Nantinya Akan Disimpan"}),e.jsx(Pa,{value:n,theme:"dark",height:"60vh",editable:!1,basicSetup:!0,autoFocus:!0,extensions:[Da(),Ia(Aa())]})]})},Et=({fields:t,field:a,remove:n})=>e.jsx(b.Item,{style:{marginBottom:0},required:!0,children:e.jsxs(z,{gap:"middle",style:{width:"100%",marginTop:"0.5rem"},children:[g.createElement(b.Item,{...a,name:[a.name,0],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai longitude."}],style:{width:"100%",marginBottom:0},key:`${a.key}-create-longitude`},e.jsx(w,{placeholder:"Longitude",disabled:!0,style:{width:"100%"}})),g.createElement(b.Item,{...a,name:[a.name,1],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai latitude."}],style:{width:"100%",marginBottom:0},key:`${a.key}-create-latitude`},e.jsx(w,{placeholder:"Latitude",disabled:!0,style:{width:"100%"}})),t.length>1?e.jsx(kt,{className:"dynamic-delete-button",onClick:()=>n(a.name)}):null]})},a.name),{Text:Hn}=D,Wn=({addRef:t})=>e.jsxs(e.Fragment,{children:[e.jsx(Hn,{children:"Titik Koordinat Batas Tempat (Longitude, Latitude)"}),e.jsx("div",{style:{maxHeight:"60vh",overflowY:"scroll"},children:e.jsx(b.List,{name:"longlat",rules:[{validator:async(a,n)=>{if(!n||n.length<3)return Promise.reject(new Error("Setidaknya Masukkan Tiga Titik Koordinat"))}}],children:(a,{add:n,remove:i})=>(t.current=n,e.jsx(e.Fragment,{children:a.map(o=>e.jsx(Et,{fields:a,field:o,remove:i},o.key))}))})})]}),rt=t=>t.length===0?null:{features:[{geometry:{coordinates:[[...t,t[0]]],type:"Polygon"},properties:{copyright:"WhatBorder Collection GeoJSON Data",creator:"WhatBorder"},type:"Feature"}],type:"FeatureCollection"},Jn=t=>{const a=t.features[0].geometry;return a.type==="Polygon"?a.coordinates[0].filter(i=>i.length===2).slice(0,-1):[[0,0]]},{Text:Gn}=D,{Option:Yn}=Be,ot=({disable:t})=>{var n;const a=O({queryKey:["building-filter"],queryFn:async()=>await Dt()});return e.jsxs(V,{children:[e.jsxs(z,{className:"flex-form-item",wrap:!0,children:[e.jsx(b.Item,{className:"form-item-location",label:"Nama",name:"placename",rules:[{required:!0,message:"Tolong Masukan Nama Tempat!"},{max:20,message:"Alamat yang anda masukan melebihi 20 karakter"}],children:e.jsx(w,{placeholder:"Nama Tempat",autoComplete:"off"})}),e.jsx(b.Item,{className:"form-item-location",label:"Pemilik",name:"placeowner",rules:[{max:20,message:"Nama pemilik yang anda masukan melebihi 20 karakter"}],children:e.jsx(w,{placeholder:"Pemilik Tempat",autoComplete:"off"})})]}),e.jsxs(z,{className:"flex-form-item",wrap:!0,children:[e.jsx(b.Item,{className:"form-item-location",label:"Alamat",name:"placeaddress",rules:[{required:!0,message:"Tolong Masukan Alamat Tempat!"},{max:50,message:"Alamat yang anda masukan melebihi 50 karakter"}],children:e.jsx(w,{placeholder:"Alamat Tempat",autoComplete:"off"})}),e.jsx(b.Item,{className:"form-item-location",label:"Jenis",name:"placetype",rules:[{required:!0,message:"Tolong Pilih Jenis Tempat!"}],children:e.jsx(Be,{placeholder:"Pilih Jenis Tempat",allowClear:!0,children:(n=a.data)==null?void 0:n.map(i=>e.jsx(Yn,{value:i.name,children:i.name},i.buildingId))})})]}),e.jsx(b.Item,{label:"Deskripsi",name:"placedesc",children:e.jsx(Vt,{showCount:!0,maxLength:100,placeholder:"Tambahkan Deskripsi Tempat",style:{height:120,resize:"none"}})}),e.jsx(Gn,{children:"Titik Tengah Tempat"}),e.jsxs(z,{className:"flex-form-item",wrap:!0,children:[e.jsx(b.Item,{className:"form-item-location",label:"Latitude",name:"placelat",rules:[{required:!0,message:"Data koordinat latitude tidak boleh kosong"},{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],children:e.jsx(w,{placeholder:"Latitude",disabled:t})}),e.jsx(b.Item,{className:"form-item-location",label:"Longitude",name:"placelong",rules:[{required:!0,message:"Data koordinat longitude tidak boleh kosong"},{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],children:e.jsx(w,{placeholder:"Longitude",disabled:t})})]})]})},{Title:Zn,Text:Qn}=D,Vn={labelCol:{span:8}},Xn=()=>{const[t,a]=g.useState(null),[n,i]=g.useState([]),o=g.useRef(()=>{}),s=G(),[u]=b.useForm(),h=ie(),x=et(),y=te({query:"(min-width: 500px)"});g.useEffect(()=>{const l=r=>{console.log(r),r.client===x.client&&r.desktop===x.desktop&&(a([r.lat,r.long]),u.setFieldsValue({placelat:r.lat,placelong:r.long}))};return h.on("centerpoint",l),()=>{h.off("centerpoint",l)}},[u,h,x.client,x.desktop]),g.useEffect(()=>{const l=r=>{console.log(r),r.client===x.client&&r.desktop===x.desktop&&(i(m=>[...m,[r.long,r.lat]]),o.current&&o.current([r.long,r.lat]))};return h.on("place-coordinate",l),()=>{h.off("place-coordinate",l)}},[x.client,x.desktop,h]);const j=rt(n);console.log(j);const k=[{key:"1",children:e.jsx(Wn,{addRef:o}),label:e.jsx($,{title:"Daftar Titik Sudut",children:e.jsx(Ge,{style:{margin:"0 auto"}})})},{key:"2",children:t&&n.length>0&&j?e.jsx(nt,{centerPoint:t,mapData:j}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan Pada Peta",children:e.jsx(Ye,{style:{margin:"0 auto"}})})},{key:"3",children:j!==null?e.jsx(st,{initialJson:j}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan File GeoJSON",children:e.jsx(Ze,{style:{margin:"0 auto"}})})}],{mutate:c}=X({mutationFn:wt,onSuccess:l=>{A.open({type:"success",content:l,duration:3}),s(-1),x.clearSocket(),h.emit("backto-dashboard","/")},onError:l=>{A.open({type:"error",content:l.response.data.message,duration:5})}}),d=l=>{const r={placeName:l.placename,placeOwner:l.placeowner,placeDescription:l.placedesc,placeAddress:l.placeaddress,placeType:l.placetype,placePoints:[l.placelat,l.placelong],placeGeojson:j};console.log(r),c(r)},p=()=>{u.resetFields()};return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{s(-1),x.clearSocket(),h.emit("backto-dashboard","/")},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Tambahkan Rincian Tempat"}]}),y?e.jsxs("div",{children:[e.jsx(Zn,{level:5,style:{marginTop:"8px"},children:"Pengaturan Penambahan Tempat Terintegrasi"}),e.jsxs(b,{...Vn,form:u,layout:"vertical",name:"create_place",onValuesChange:l=>{l.longlat&&(console.log("Updated longlat array:",l.longlat),i(l.longlat))},onFinish:d,children:[e.jsx(b.Item,{children:e.jsxs(B,{style:{width:"100%",justifyContent:"end"},children:[e.jsx(C,{type:"primary",htmlType:"submit",children:"Tambahkan"}),e.jsx(C,{htmlType:"button",onClick:p,children:"Ulangi"})]})}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(ot,{disable:!0})}),e.jsx(E,{xs:24,md:12,children:e.jsx(V,{children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,items:k.map(l=>({key:l.key,children:l.children,label:l.label}))})})})]})]})]}):e.jsx(fe,{status:"404",title:"Perangkat anda terlalu kecil",subTitle:"Maaf, halaman yang Anda kunjungi tidak dapat ditampilkan secara baik pada perangkat Anda.",extra:e.jsx(Qn,{style:{fontSize:"12px"},children:"Petunjuk: Buka secara lanskap / coba gunakan perangkat lainnya"})})]})},{Text:es}=D,ts=({form:t})=>{const a=g.useRef(),n=()=>{const i=t.getFieldsValue(["longmanual","latmanual"]);console.log("Longitude:",Number(i.longmanual)),console.log("Latitude:",Number(i.latmanual)),a.current&&a.current([Number(i.longmanual),Number(i.latmanual)])};return e.jsxs(e.Fragment,{children:[e.jsx(es,{children:"Titik Koordinat Batas Tempat (Longitude, Latitude)"}),e.jsx(b.Item,{style:{marginBottom:0},required:!0,children:e.jsxs(z,{gap:"middle",style:{width:"100%",marginTop:"0.5rem"},children:[e.jsx(b.Item,{name:"longmanual",validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai longitude."},{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],style:{width:"100%",marginBottom:0},children:e.jsx(w,{placeholder:"Longitude",style:{width:"100%"}})}),e.jsx(b.Item,{name:"latmanual",validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai latitude."},{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],style:{width:"100%",marginBottom:0},children:e.jsx(w,{placeholder:"Latitude",style:{width:"100%"}})})]})}),e.jsx(b.Item,{children:e.jsx(C,{type:"dashed",onClick:()=>n(),style:{width:"60%",marginTop:"10px"},icon:e.jsx(ft,{}),children:"Tambah Koordinat"})}),e.jsx("div",{style:{maxHeight:"60vh",overflowY:"scroll"},children:e.jsx(b.List,{name:"longlat",rules:[{validator:async(i,o)=>{if(!o||o.length<3)return Promise.reject(new Error("Setidaknya Masukkan Tiga Titik Koordinat"))}}],children:(i,{add:o,remove:s})=>(a.current=o,e.jsx(e.Fragment,{children:i.map(u=>e.jsx(Et,{fields:i,field:u,remove:s},u.key))}))})})]})},{Title:as,Text:ns}=D,ss={labelCol:{span:8}},rs=()=>{const[t,a]=g.useState(null),[n,i]=g.useState([]),o=G(),[s]=b.useForm(),u=te({query:"(min-width: 500px)"}),h=rt(n);console.log(h);const x=[{key:"1",children:t?e.jsx(ts,{form:s}):e.jsx(K,{description:"Harap Tambahkan Titik Pusat Terlebih Dahulu"}),label:e.jsx($,{title:"Daftar Titik Sudut",children:e.jsx(Ge,{style:{margin:"0 auto"}})})},{key:"2",children:t&&n.length!==0&&h?e.jsx(nt,{centerPoint:t,mapData:h}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan Pada Peta",children:e.jsx(Ye,{style:{margin:"0 auto"}})})},{key:"3",children:h!==null?e.jsx(st,{initialJson:h}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan File GeoJSON",children:e.jsx(Ze,{style:{margin:"0 auto"}})})}],{mutate:y}=X({mutationFn:wt,onSuccess:c=>{A.open({type:"success",content:c,duration:3}),o(-1)},onError:c=>{A.open({type:"error",content:c.response.data.message,duration:5})}}),j=c=>{const d={placeName:c.placename,placeOwner:c.placeowner,placeDescription:c.placedesc,placeAddress:c.placeaddress,placeType:c.placetype,placePoints:t,placeGeojson:h};console.log(d),y(d)},k=()=>{s.resetFields()};return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{o(-1)},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Tambahkan Rincian Tempat"}]}),u?e.jsxs("div",{children:[e.jsx(as,{level:5,style:{marginTop:"8px"},children:"Pengaturan Penambahan Tempat Manual"}),e.jsxs(b,{...ss,form:s,layout:"vertical",name:"create_place",onValuesChange:c=>{c.longlat&&(console.log("Updated longlat array:",c.longlat),i(c.longlat)),(c.placelat||c.placelong)&&a(d=>{if(d){const p=c.placelat?Number(c.placelat):d[0],l=c.placelong?Number(c.placelong):d[1];return[p,l]}else return[c.placelat?Number(c.placelat):0,c.placelong?Number(c.placelong):0]})},onFinish:j,children:[e.jsx(b.Item,{children:e.jsxs(B,{style:{width:"100%",justifyContent:"end"},children:[e.jsx(C,{type:"primary",htmlType:"submit",children:"Tambahkan"}),e.jsx(C,{htmlType:"button",onClick:k,children:"Ulangi"})]})}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(ot,{disable:!1})}),e.jsx(E,{xs:24,md:12,children:e.jsx(V,{children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,items:x.map(c=>({key:c.key,children:c.children,label:c.label}))})})})]})]})]}):e.jsx(fe,{status:"404",title:"Perangkat anda terlalu kecil",subTitle:"Maaf, halaman yang Anda kunjungi tidak dapat ditampilkan secara baik pada perangkat Anda.",extra:e.jsx(ns,{style:{fontSize:"12px"},children:"Petunjuk: Buka secara lanskap / coba gunakan perangkat lainnya"})})]})},os=({lat:t,long:a,fields:n,field:i,remove:o,form:s})=>{const[u,h]=g.useState(t),[x,y]=g.useState(a),[j,k]=g.useState(!0);g.useEffect(()=>{const d=s.getFieldValue(["longlat",i.name,"lat"]),p=s.getFieldValue(["longlat",i.name,"long"]);(d!==x||p!==u)&&(y(d),h(p))},[s,i.name,x,u]);const c=()=>k(d=>!d);return e.jsx(b.Item,{style:{marginBottom:0},required:!0,children:e.jsxs(z,{gap:"middle",style:{width:"100%",marginTop:"0.5rem"},children:[g.createElement(b.Item,{...i,name:[i.name,"long"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai longitude."}],style:{width:"100%",marginBottom:0},key:`${i.key}-update-longitude`},e.jsx(w,{placeholder:"Longitude",disabled:j,style:{width:"100%"}})),g.createElement(b.Item,{...i,name:[i.name,"lat"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Harap masukkan nilai latitude."}],style:{width:"100%",marginBottom:0},key:`${i.key}-update-latitude`},e.jsx(w,{placeholder:"Latitude",disabled:j,style:{width:"100%"}})),n.length>=1&&e.jsxs(e.Fragment,{children:[e.jsx(kt,{className:"dynamic-delete-button",onClick:()=>o(i.name)}),e.jsx(Fe,{className:"dynamic-lock-button",onClick:c,style:{color:j?"red":"green",cursor:"pointer"}})]})]})},i.name)},{Text:is}=D,ls=({form:t,initiateValue:a})=>{const[n,i]=Ht.useState(null),o=g.useRef();g.useEffect(()=>{a&&i(a)},[a]),g.useEffect(()=>{if(n&&n.length>0){console.log("Initial Data:",n);const u=n.map(([h,x])=>({long:h,lat:x}));console.log(u),t.setFieldsValue({longlat:u})}},[t,n]);const s=()=>{const u=t.getFieldsValue(["longmanual","latmanual"]);console.log("Longitude:",Number(u.longmanual)),console.log("Latitude:",Number(u.latmanual)),o.current&&o.current({long:Number(u.longmanual),lat:Number(u.latmanual)})};return e.jsxs("div",{style:{height:"63vh",overflowY:"scroll"},children:[e.jsx(is,{children:"Titik Koordinat Batas Tempat (Longitude, Latitude)"}),e.jsx(b.Item,{style:{marginBottom:0},required:!0,children:e.jsxs(z,{gap:"middle",style:{width:"100%",marginTop:"0.5rem"},children:[e.jsx(b.Item,{name:"longmanual",validateTrigger:["onChange","onBlur"],rules:[{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],style:{width:"100%",marginBottom:0},children:e.jsx(w,{placeholder:"Longitude",style:{width:"100%"}})}),e.jsx(b.Item,{name:"latmanual",validateTrigger:["onChange","onBlur"],rules:[{pattern:/^-?\d+\.\d+$/,message:"Masukkan format angka yang valid"}],style:{width:"100%",marginBottom:0},children:e.jsx(w,{placeholder:"Latitude",style:{width:"100%"}})})]})}),e.jsx(b.Item,{children:e.jsx(C,{type:"dashed",onClick:()=>s(),style:{width:"60%",marginTop:"10px"},icon:e.jsx(ft,{}),children:"Tambah Koordinat"})}),e.jsx(b.List,{name:"longlat",rules:[{validator:async(u,h)=>{if(!h||h.length<3)return Promise.reject(new Error("Setidaknya Masukkan Tiga Titik Koordinat"))}}],children:(u,{add:h,remove:x})=>{o.current=h;const y=j=>{console.log(j),x(j);const k=t.getFieldValue("longlat")||[];console.log("Updated List Before Formatting:",k);const c=k.map(d=>[Number(d.long),Number(d.lat)]);console.log("Formatted List:",c),i(c)};return e.jsx(e.Fragment,{children:u.map(j=>e.jsx(os,{fields:u,field:j,remove:y,lat:t.getFieldValue(["longlat",j.name,"lat"]),long:t.getFieldValue(["longlat",j.name,"long"]),form:t},j.key))})}})]})},{Title:cs,Text:ds}=D,us={labelCol:{span:8}},ps=()=>{const{id:t}=Ve(),a=G(),[n,i]=g.useState(null),[o,s]=g.useState([]),{data:u,isLoading:h}=O({queryKey:["place-update",t],queryFn:async()=>await vt(t)}),[x]=b.useForm(),y=te({query:"(min-width: 500px)"}),j=r=>{var m,S;if(r){const L=Jn(r==null?void 0:r.placeMap.place_geojson);console.log(L),x.setFieldsValue({placename:r==null?void 0:r.placeName,placeowner:r==null?void 0:r.placeOwner,placeaddress:r==null?void 0:r.placeAddress,placetype:r==null?void 0:r.type.name,placedesc:r==null?void 0:r.placeDescription,placelong:(m=r==null?void 0:r.placeCenterPoint)==null?void 0:m[1],placelat:(S=r==null?void 0:r.placeCenterPoint)==null?void 0:S[0]}),i(r==null?void 0:r.placeCenterPoint),s(L)}};g.useEffect(()=>{u&&j(u)},[u,x]);const k=rt(o);console.log(k);const c=[{key:"1",children:n?e.jsx(ls,{form:x,initiateValue:o}):e.jsx(K,{description:"Harap Tambahkan Titik Pusat Terlebih Dahulu"}),label:e.jsx($,{title:"Daftar Titik Sudut",children:e.jsx(Ge,{style:{margin:"0 auto"}})})},{key:"2",children:n&&o.length!==0&&k?e.jsx(nt,{centerPoint:n,mapData:k}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan Pada Peta",children:e.jsx(Ye,{style:{margin:"0 auto"}})})},{key:"3",children:k!==null?e.jsx(st,{initialJson:k}):e.jsx(K,{description:"Lokasi Belum Ditentukan"}),label:e.jsx($,{title:"Tampilan File GeoJSON",children:e.jsx(Ze,{style:{margin:"0 auto"}})})}],{mutate:d}=X({mutationFn:r=>za(r.id,r.data),onSuccess:r=>{A.open({type:"success",content:r,duration:3}),a(-1)},onError:r=>{A.open({type:"error",content:r.response.data.message,duration:5})}}),p=r=>{const m={};r.placename&&r.placename!==u.placeName&&(m.placeName=r.placename),r.placeowner&&r.placeowner!==u.placeOwner&&(m.placeOwner=r.placeowner),r.placedesc&&r.placedesc!==u.placeDescription&&(m.placeDescription=r.placedesc),r.placeaddress&&r.placeaddress!==u.placeAddress&&(m.placeAddress=r.placeaddress),r.placetype&&r.placetype!==u.type.name&&(m.placeType=r.placetype),r.placelat&&r.placelat!==u.placeCenterPoint[0]&&r.placelong&&r.placelong!==u.placeCenterPoint[1]&&(m.placePoints=[r.placelat,r.placelong]);const S=JSON.stringify(u==null?void 0:u.placeMap.place_geojson);if(JSON.stringify(k)!==S&&(m.placeGeojson=k),Object.keys(m).length===0){A.info("Tidak ada perubahan data");return}d({id:t,data:m})},l=()=>{x.resetFields(),u&&j(u),A.info("Form berhasil disetel ulang")};return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{a(-1)},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Perbarui Rincian Tempat"}]}),y?e.jsxs("div",{children:[e.jsx(cs,{level:5,style:{marginTop:"8px"},children:"Pengaturan Pembaharuan Tempat Manual"}),e.jsxs(b,{...us,form:x,layout:"vertical",name:"create_place",onValuesChange:r=>{if(r.longlat){console.log("Updated longlat array:",r.longlat);const m=r.longlat.map(S=>[Number(S.long),Number(S.lat)]);console.log("Formatted List:",m),s(m)}(r.placelat||r.placelong)&&i(m=>{if(m){const S=r.placelat?Number(r.placelat):m[0],L=r.placelong?Number(r.placelong):m[1];return[S,L]}else return[r.placelat?Number(r.placelat):0,r.placelong?Number(r.placelong):0]})},onFinish:p,children:[e.jsx(b.Item,{children:e.jsxs(B,{style:{width:"100%",justifyContent:"end"},children:[e.jsx(C,{type:"primary",htmlType:"submit",children:"Perbarui"}),e.jsx(C,{htmlType:"button",onClick:l,children:"Ulangi"})]})}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(Z,{loading:h,active:!0,paragraph:{rows:5},children:e.jsx(ot,{disable:!1})})}),e.jsx(E,{xs:24,md:12,children:e.jsx(Z,{loading:h,active:!0,paragraph:{rows:5},children:e.jsx(V,{children:e.jsx(oe,{defaultActiveKey:"1",centered:!0,items:c.map(r=>({key:r.key,children:r.children,label:r.label}))})})})})]})]})]}):e.jsx(fe,{status:"404",title:"Perangkat anda terlalu kecil",subTitle:"Maaf, halaman yang Anda kunjungi tidak dapat ditampilkan secara baik pada perangkat Anda.",extra:e.jsx(ds,{style:{fontSize:"12px"},children:"Petunjuk: Buka secara lanskap / coba gunakan perangkat lainnya"})})]})},{Title:ms}=D,hs=({data:t,isLoading:a})=>{const[n,i]=g.useState(""),[o,s]=g.useState(""),u=g.useRef(null),h=(c,d,p)=>{d(),i(c[0]),s(p)},x=c=>{c(),i("")},y=c=>({filterDropdown:({setSelectedKeys:d,selectedKeys:p,confirm:l,clearFilters:r,close:m})=>e.jsxs("div",{style:{padding:8},onKeyDown:S=>S.stopPropagation(),children:[e.jsx(w,{ref:u,placeholder:`Search ${c}`,value:p[0],onChange:S=>d(S.target.value?[S.target.value]:[]),onPressEnter:()=>h(p,l,c),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>h(p,l,c),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{r&&x(r),l({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{m()},children:"Tutup"})]})]}),filterIcon:d=>e.jsx(H,{style:{color:d?"#1677ff":void 0}}),onFilter:(d,p)=>p[c].toString().toLowerCase().includes(d.toLowerCase()),render:d=>o===c?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:d?d.toString():""}):d}),j=c=>{console.log(c)},k=[{title:"Nama Tempat",dataIndex:"name",key:"building-name",...y("name")},{title:"Warna Label Tempat",dataIndex:"label",key:"building-label",align:"center",responsive:["lg"],render:(c,{label:d})=>e.jsx(re,{defaultValue:d,showText:!0,disabled:!0})},{title:"Warna Peta Tempat",dataIndex:"color",key:"place-color",align:"center",responsive:["xl"],render:(c,{color:d})=>e.jsx(re,{defaultValue:d,showText:!0,disabled:!0})},{title:"Aksi",key:"place-type-action",align:"center",width:"50px",render:(c,{buildingId:d})=>e.jsx(Ne,{placement:"left",title:"Yakin nih mau dihapus?",description:"Semua data terkait tempat ini akan hilang",onConfirm:()=>j(d),okText:"Yakin",cancelText:"Tidak Dulu",children:e.jsx(be,{style:{color:"red"}})})}];return e.jsxs(V,{style:{height:"600px"},children:[e.jsx(ms,{level:4,children:"Daftar Tipe Tempat"}),e.jsx(W,{pagination:{position:["topRight"],pageSize:8},size:"small",sticky:!0,style:{background:"transparent"},loading:a,columns:k,rowKey:({buildingId:c})=>c,dataSource:t,locale:{emptyText:e.jsx(K,{description:"Anda Belum Menambahkan Data Tempat"})}})]})},{Title:pt}=D,gs=()=>{const[t]=b.useForm(),[a,n]=g.useState("#1677ff"),i=Bt(a),o=!i,[s,u]=g.useState(null),[h,x]=g.useState(null),y=d=>{d&&(t.setFieldValue("labelupdate",d),u(d))},j=d=>{d&&(t.setFieldValue("colorupdate",d),x(d))},k=d=>{console.log(d)},c=()=>{u(null),x(null),t.resetFields()};return e.jsx("div",{style:{minHeight:"500px"},children:e.jsxs(b,{form:t,layout:"vertical",name:"place_type_create",onFinish:k,children:[e.jsx(b.Item,{label:"Nama Tipe Tempat",name:"namecreate",rules:[{required:!0,message:"Nama Tipe Tempat wajib diisi"}],children:e.jsx(w,{placeholder:"Masukkan nama tipe tempat"})}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(re,{style:{marginBottom:8},value:a,onChange:d=>n(d.toHexString()),showText:!0,disabledAlpha:!0}),e.jsx(pt,{level:5,children:"Tentukan Warna Dasar Label"}),o&&e.jsx(ve,{message:"Pilih warna dengan brightness lebih tinggi dari 30 dan saturation lebih tinggi dari 30!",type:"warning",showIcon:!0}),!o&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",marginBottom:16,gap:"2px"},children:i.map((d,p)=>e.jsxs("div",{className:"color-palette-box",style:{backgroundColor:d,color:p<5?"black":"white",fontWeight:p===5?"bold":"normal",opacity:h===d?.5:1,cursor:h===d?"not-allowed":"pointer"},onClick:()=>y(d),children:[e.jsxs("span",{style:{fontSize:"10px",fontWeight:"bold"},children:["L-",p+1]}),e.jsx("span",{className:"color-palette-code",style:{fontSize:"12px"},children:d.toUpperCase()})]},p))}),e.jsx(pt,{level:5,children:"Tentukan Warna Dasar Peta"}),o&&e.jsx(ve,{message:"Pilih warna dengan brightness lebih tinggi dari 30 dan saturation lebih tinggi dari 30!",type:"warning",showIcon:!0}),!o&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"2px"},children:i.map((d,p)=>e.jsxs("div",{className:"color-palette-box",style:{backgroundColor:d,color:p<5?"black":"white",fontWeight:p===5?"bold":"normal",opacity:s===d?.5:1,cursor:s===d?"not-allowed":"pointer"},onClick:()=>j(d),children:[e.jsxs("span",{style:{fontSize:"10px",fontWeight:"bold"},children:["L-",p+1]}),e.jsx("span",{className:"color-palette-code",style:{fontSize:"12px"},children:d.toUpperCase()})]},p))})]}),e.jsxs(z,{justify:"space-around",children:[e.jsx(b.Item,{label:"Warna Label Tempat Terpilih",name:"labelcreate",children:e.jsx(re,{size:"small",value:a,showText:!0,disabled:!0})}),e.jsx(b.Item,{label:"Warna Peta Tempat Terpilih",name:"colorcreate",children:e.jsx(re,{size:"small",value:a,showText:!0,disabled:!0})})]}),e.jsx(b.Item,{style:{marginBottom:0},children:e.jsxs(B,{style:{width:"100%",justifyContent:"end"},children:[e.jsx(C,{type:"primary",htmlType:"submit",children:"Simpan"}),e.jsx(C,{htmlType:"button",onClick:c,children:"Ulangi"})]})})]})})},{Title:mt,Text:xs}=D,{Option:ys}=Be,js=({data:t})=>{const[a]=b.useForm(),[n,i]=g.useState("#1677ff"),o=Bt(n),s=!o,[u,h]=g.useState(null),[x,y]=g.useState(null),j=l=>{l&&(a.setFieldValue("labelupdate",l),h(l))},k=l=>{l&&(a.setFieldValue("colorupdate",l),y(l))},c=l=>{const r=t.find(m=>m.buildingId===l);r&&(a.setFieldsValue({nameupdate:r.name,labelupdate:r.label,colorupdate:r.color}),i(r.label))},d=l=>{console.log(l)},p=()=>{(u!==null||x!==null)&&(h(null),y(null)),a.resetFields()};return e.jsx("div",{style:{minHeight:"500px"},children:e.jsxs(b,{form:a,layout:"vertical",name:"place_type_update",onFinish:d,children:[e.jsx(xs,{children:"Pilih Jenis Tempat Yang Ingin Diubah : "}),e.jsx(Be,{style:{marginBlock:8,width:"100%"},placeholder:"Pilih Jenis Tempat",onChange:c,children:t==null?void 0:t.map(l=>e.jsx(ys,{value:l.buildingId,children:l.name},l.buildingId))}),e.jsx(b.Item,{label:"Nama Tipe Tempat",name:"nameupdate",rules:[{required:!0,message:"Nama Tipe Tempat wajib diisi"}],children:e.jsx(w,{placeholder:"Masukkan nama tipe tempat"})}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(re,{style:{marginBottom:8},value:n,onChange:l=>i(l.toHexString()),showText:!0,disabledAlpha:!0}),e.jsx(mt,{level:5,children:"Tentukan Warna Dasar Label"}),s&&e.jsx(ve,{message:"Pilih warna dengan brightness lebih tinggi dari 30 dan saturation lebih tinggi dari 30!",type:"warning",showIcon:!0}),!s&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",marginBottom:16,gap:"2px"},children:o.map((l,r)=>e.jsxs("div",{className:"color-palette-box",style:{backgroundColor:l,color:r<5?"black":"white",fontWeight:r===5?"bold":"normal",opacity:x===l?.5:1,cursor:u===l?"not-allowed":"pointer"},onClick:()=>j(l),children:[e.jsxs("span",{style:{fontSize:"10px",fontWeight:"bold"},children:["L-",r+1]}),e.jsx("span",{className:"color-palette-code",style:{fontSize:"12px"},children:l.toUpperCase()})]},r))}),e.jsx(mt,{level:5,children:"Tentukan Warna Dasar Peta"}),s&&e.jsx(ve,{message:"Pilih warna dengan brightness lebih tinggi dari 30 dan saturation lebih tinggi dari 30!",type:"warning",showIcon:!0}),!s&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"2px"},children:o.map((l,r)=>e.jsxs("div",{className:"color-palette-box",style:{backgroundColor:l,color:r<5?"black":"white",fontWeight:r===5?"bold":"normal",opacity:u===l?.5:1,cursor:u===l?"not-allowed":"pointer"},onClick:()=>k(l),children:[e.jsxs("span",{style:{fontSize:"10px",fontWeight:"bold"},children:["L-",r+1]}),e.jsx("span",{className:"color-palette-code",style:{fontSize:"12px"},children:l.toUpperCase()})]},r))})]}),e.jsxs(z,{justify:"space-around",children:[e.jsx(b.Item,{label:"Warna Label Tempat Terpilih",name:"labelupdate",children:e.jsx(re,{size:"small",value:n,showText:!0,disabled:!0})}),e.jsx(b.Item,{label:"Warna Peta Tempat Terpilih",name:"colorupdate",children:e.jsx(re,{size:"small",value:n,showText:!0,disabled:!0})})]}),e.jsx(b.Item,{style:{marginBottom:0},children:e.jsxs(B,{style:{width:"100%",justifyContent:"end"},children:[e.jsx(C,{type:"primary",htmlType:"submit",children:"Perbarui"}),e.jsx(C,{htmlType:"button",onClick:p,children:"Ulangi"})]})})]})})},{Title:ks}=D,fs=()=>{const t=G(),{data:a,isLoading:n}=O({queryKey:["building-list"],queryFn:async()=>await Dt()}),i=[{key:"1",children:e.jsx(gs,{}),label:"Tambah Jenis Tempat"},{key:"2",children:e.jsx(js,{data:a}),label:"Ubah Jenis Tempat"}];return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{t(-1)},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Info Jenis Tempat"}]}),e.jsx("div",{children:e.jsx(ks,{level:5,style:{marginTop:"8px"},children:"Pengaturan Jenis Tempat"})}),e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(V,{children:e.jsx(oe,{defaultActiveKey:"1",items:i.map(o=>({key:o.key,children:o.children,label:o.label}))})})}),e.jsx(E,{xs:24,md:12,children:e.jsx(hs,{data:a,isLoading:n})})]})]})},Ut=({position:t,setPosition:a,setLat:n,setLong:i})=>{const o=()=>(Ca({click(u){const{lat:h,lng:x}=u.latlng;a([h,x]),n(h),i(x)}}),null),s=()=>{const u=Tt();return t&&u.flyTo(t,17),null};return e.jsx(V,{children:e.jsxs(ue,{center:t||[-1.2480891,118],zoom:4,scrollWheelZoom:!0,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t&&e.jsxs(e.Fragment,{children:[e.jsx(bt,{position:t}),e.jsx(s,{})," "]}),e.jsx(o,{})]})})},{Text:Oe}=D,bs=({client:t,desktop:a})=>{const[n,i]=g.useState(0),[o,s]=g.useState(0),[u,h]=g.useState(!1),[x,y]=g.useState(!0),[j,k]=g.useState(null),c=ie(),d=()=>{h(!0),navigator.geolocation.getCurrentPosition(p=>{const{latitude:l,longitude:r}=p.coords;i(l),s(r),k([l,r]),y(!1),h(!1),console.log(`Latitude: ${l}, Longitude: ${r}`)},p=>{switch(h(!1),p.code){case p.PERMISSION_DENIED:console.error("User denied the request for Geolocation.");break;case p.POSITION_UNAVAILABLE:console.error("Location information is unavailable.");break;case p.TIMEOUT:console.error("The request to get user location timed out.");break;default:console.error("An unknown error occurred.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(Ut,{position:j,setPosition:k,setLat:i,setLong:s})}),e.jsx(E,{xs:24,md:12,children:e.jsxs(V,{children:[e.jsx(Oe,{style:{fontWeight:"bold"},children:"Tambahkan Titik Pusat Tempat"}),e.jsx(C,{style:{marginTop:"1rem",width:"100%"},onClick:d,disabled:u,children:u?e.jsx(Je,{}):"Cari Titik Pusat"}),e.jsxs("div",{style:{paddingBlock:"1rem"},children:[e.jsxs(Oe,{children:["Latitude: ",n]}),e.jsx("br",{}),e.jsxs(Oe,{children:["Longitude: ",o]})]}),e.jsx(C,{disabled:x,style:{width:"100%"},onClick:()=>{c.emit("set-centerpoint",{lat:n,long:o,client:t,desktop:a}),y(!0)},children:"Gunakan Koordinat"})]})})]})},{Text:_e}=D,Ts=({client:t,desktop:a})=>{const[n,i]=g.useState(0),[o,s]=g.useState(0),[u,h]=g.useState(!1),[x,y]=g.useState(!0),[j,k]=g.useState(null),c=ie(),d=()=>{h(!0),navigator.geolocation.getCurrentPosition(p=>{const{latitude:l,longitude:r}=p.coords;i(l),s(r),k([l,r]),y(!1),h(!1),console.log(`Latitude: ${l}, Longitude: ${r}`)},p=>{switch(h(!1),p.code){case p.PERMISSION_DENIED:console.error("User denied the request for Geolocation.");break;case p.POSITION_UNAVAILABLE:console.error("Location information is unavailable.");break;case p.TIMEOUT:console.error("The request to get user location timed out.");break;default:console.error("An unknown error occurred.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return e.jsxs(ee,{gutter:[16,16],wrap:!0,children:[e.jsx(E,{xs:24,md:12,children:e.jsx(Ut,{position:j,setPosition:k,setLat:i,setLong:s})}),e.jsx(E,{xs:24,md:12,children:e.jsxs(V,{children:[e.jsx(_e,{children:"Tambahkan Titik Sudut Batas Tempat"}),e.jsx(C,{style:{marginTop:"1rem",width:"100%"},onClick:d,disabled:u,children:u?e.jsx(Je,{}):"Cari Titik Sudut Batas"}),e.jsxs(z,{style:{paddingBlock:"1rem"},gap:"small",vertical:!0,children:[e.jsxs(_e,{children:["Longitude: ",o]}),e.jsxs(_e,{children:["Latitude: ",n]})]}),e.jsx(C,{disabled:x,style:{width:"100%"},onClick:()=>{c.emit("set-place-coordinate",{lat:n,long:o,client:t,desktop:a}),y(!0)},children:"Gunakan Koordinat"})]})})]})},{Title:Cs}=D,Ss=()=>{const t=G(),[a,n]=g.useState(0),i=ie(),o=et();g.useEffect(()=>{const y=j=>{console.log(j),j&&(o.clearSocket(),t(j))};return i.on("navigateto-dashboard",y),()=>{i.off("navigateto-dashboard",y)}},[]);const s=()=>{n(a+1)},u=()=>{n(a-1)},h=[{title:"Titik Pusat",content:e.jsx(bs,{client:o.client,desktop:o.desktop})},{title:"Pola Tempat",content:e.jsx(Ts,{client:o.client,desktop:o.desktop})}],x=h.map(y=>({key:y.title,title:y.title}));return e.jsxs(e.Fragment,{children:[e.jsx(Cs,{level:5,style:{marginTop:"8px"},children:"Pengaturan Koordinat"}),e.jsxs(B,{direction:"vertical",style:{width:"100%"},children:[e.jsx(Xt,{style:{marginBottom:"0.75rem"},responsive:!1,current:a,items:x}),e.jsx("div",{children:h[a].content}),e.jsxs("div",{style:{marginTop:24},children:[a<h.length-1&&e.jsx(C,{type:"primary",onClick:()=>s(),children:"Lanjut"}),a>0&&e.jsx(C,{style:{margin:"0 8px"},onClick:()=>u(),children:"Kembali"})]})]})]})},{Text:ws}=D,vs=()=>{const t=ye(),{data:a,isLoading:n}=O({queryKey:["admin-place-access"],queryFn:async()=>await Za(),staleTime:300*1e3}),{mutate:i}=X({mutationFn:Qa,onSuccess:p=>{t.invalidateQueries({queryKey:["admin-place-access"]}),A.open({type:"success",content:p,duration:3})},onError:p=>{A.open({type:"error",content:p.response.data.message,duration:5})}}),[o,s]=g.useState(""),[u,h]=g.useState(""),x=g.useRef(null),y=(p,l,r)=>{l({closeDropdown:!0}),s(p[0]),h(r)},j=p=>{p(),s("")},k=p=>({filterDropdown:({setSelectedKeys:l,selectedKeys:r,confirm:m,clearFilters:S,close:L})=>e.jsxs("div",{style:{padding:8},onKeyDown:M=>M.stopPropagation(),children:[e.jsx(w,{ref:x,placeholder:`Search ${p}`,value:r[0],onChange:M=>l(M.target.value?[M.target.value]:[]),onPressEnter:()=>y(r,m,p),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>y(r,m,p),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{S&&j(S),m({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{L()},children:"Tutup"})]})]}),filterIcon:l=>e.jsx(H,{style:{color:l?"#1677ff":void 0}}),onFilter:(l,r)=>r[p].toString().toLowerCase().includes(l.toLowerCase()),render:l=>u===p?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[o],autoEscape:!0,textToHighlight:l?l.toString():""}):l}),c=p=>{i(p)},d=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name",...k("placeName")},{title:"Tipe",dataIndex:"type",key:"place-type",width:"150px",responsive:["md"],render:(p,{type:l})=>e.jsx(Q,{style:{margin:"0"},color:l.label,children:l.name.toUpperCase()})},{title:"Pembuat",dataIndex:"createdBy",key:"place-creator",align:"center",width:"150px",responsive:["sm"],...k("createdBy"),render:(p,{createdBy:l})=>e.jsx(ws,{strong:!0,children:l})},{title:"Aksi",key:"place-action",align:"center",width:"50px",render:(p,{placeId:l})=>e.jsx(Ne,{placement:"left",title:"Yakin nih mau dihapus?",description:"Semua data terkait tempat ini akan hilang",onConfirm:()=>c(l),okText:"Yakin",cancelText:"Tidak Dulu",children:e.jsx(be,{style:{color:"red"}})})}];return e.jsx(W,{size:"small",sticky:!0,style:{backgroundColor:"transparent"},loading:n,columns:d,dataSource:a,rowKey:({placeId:p})=>p,locale:{emptyText:e.jsx(K,{description:"Anda Belum Menambahkan Data Tempat"})},expandable:{expandedRowRender:({placeId:p,placeOwner:l,placeDescription:r,placeMap:m,placeCenterPoint:S,placeAddress:L,type:M,createdAt:R,updatedAt:I})=>e.jsxs("div",{style:{paddingInline:"8px",paddingBottom:"8px"},children:[e.jsx(ke,{size:"small",style:{marginBottom:"1em"},title:"Info Tempat",items:[{key:"1",label:"Ditambahkan Pada",children:J(R)},{key:"2",label:"Diperbarui Pada",children:J(I)},{key:"3",label:"Pemilik Tempat",children:l||"-"},{key:"4",label:"Alamat Tempat",children:L},{key:"5",label:"Penjelasan Tempat",children:r||"-"}]}),e.jsx($t,{placeCenterPoint:S,placeId:p,color:M.color,placeMap:m})]})}})},{Title:Ps}=D,Ds=()=>{const t=G();return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{t(-1)},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Info Tempat"}]}),e.jsxs("div",{children:[e.jsx(Ps,{level:5,style:{marginTop:"8px"},children:"Pengaturan Data Tempat"}),e.jsx(vs,{})]})]})},Is=()=>{const{data:t,isLoading:a}=O({queryKey:["user-list","only"],queryFn:async()=>await Ga()}),[n,i]=g.useState(""),[o,s]=g.useState(""),u=g.useRef(null),h=(c,d,p)=>{d({closeDropdown:!0}),i(c[0]),s(p)},x=c=>{c(),i("")},y=c=>({filterDropdown:({setSelectedKeys:d,selectedKeys:p,confirm:l,clearFilters:r,close:m})=>e.jsxs("div",{style:{padding:8},onKeyDown:S=>S.stopPropagation(),children:[e.jsx(w,{ref:u,placeholder:`Search ${c}`,value:p[0],onChange:S=>d(S.target.value?[S.target.value]:[]),onPressEnter:()=>h(p,l,c),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>h(p,l,c),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{r&&x(r),l({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{m()},children:"Tutup"})]})]}),filterIcon:d=>e.jsx(H,{style:{color:d?"#1677ff":void 0}}),onFilter:(d,p)=>p[c].toString().toLowerCase().includes(d.toLowerCase()),render:d=>o===c?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:d?d.toString():""}):d}),j=c=>{console.log(c)},k=[{title:"Nama Pengguna",dataIndex:"userName",key:"user-name",...y("userName")},{title:"Status Pengguna",dataIndex:"admin",key:"user-role",render:(c,d)=>{const p=d.role.label,l=d.role.roleName;return e.jsx(Q,{color:p,children:l.toUpperCase()})}},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"user-create",align:"center",sorter:(c,d)=>new Date(d.createdAt).getTime()-new Date(c.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",responsive:["md"],render:(c,d)=>{const p=J(d.createdAt);return e.jsx("p",{children:p})}},{title:"Aksi",key:"role-action",align:"center",width:"50px",render:(c,{userId:d})=>e.jsx(Ne,{placement:"left",title:"Yakin nih mau dihapus?",description:"Semua data terkait pengguna ini akan hilang",onConfirm:()=>j(d),okText:"Yakin",cancelText:"Tidak Dulu",children:e.jsx(be,{style:{color:"red"}})})}];return e.jsx(W,{size:"small",sticky:!0,style:{backgroundColor:"transparent"},loading:a,columns:k,dataSource:t,rowKey:({userId:c})=>c,locale:{emptyText:e.jsx(K,{description:"Anda Belum Menambahkan Data Tempat"})}})},{Title:As}=D,Ls=()=>{const t=G();return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{onClick:()=>{t(-1)},title:e.jsx(C,{type:"link",className:"home-breadcrumb",children:"Kembali"})},{title:"Info Pengguna"}]}),e.jsxs("div",{children:[e.jsx(As,{level:5,style:{marginTop:"8px"},children:"Pengaturan Data Pengguna"}),e.jsx(Is,{})]})]})},Ot=t=>e.jsx(W,{bordered:!0,sticky:!0,style:{backgroundColor:"transparent"},...t,rowKey:({placeId:a})=>a,locale:{emptyText:e.jsx(K,{description:"Anda Tidak Memiliki Tempat Untuk Dibandingkan"})}}),_t=t=>{const{leftColumns:a,rightColumns:n,...i}=t,[o,s]=g.useState(0),u=3;return e.jsx(ea,{locale:{itemsUnit:"Daftar Tempat",itemUnit:"Tempat Dibandingkan"},style:{width:"100%"},...i,children:({direction:h,filteredItems:x,onItemSelect:y,onItemSelectAll:j,selectedKeys:k,disabled:c})=>{const d=h==="left"?a:n,p=(m,S)=>{const L=o+(S?1:-1);if(h==="left"&&S&&o>=u){A.warning(`You can only select up to ${u} items in the right table.`);return}s(L),y(m,S)},l=(m,S)=>{if(h==="left"&&S==="replace"&&m.length>u-o){A.warning(`Kamu hanya dapat memilih tempak sampai ${u} tempat di tabel kanan.`);return}s(m.length),j(m,S)},r={getCheckboxProps:()=>({disabled:c}),onChange(m){l(m,"replace")},selectedRowKeys:k,selections:[W.SELECTION_ALL,W.SELECTION_INVERT,W.SELECTION_NONE]};return e.jsx(W,{rowSelection:r,columns:d,dataSource:x,size:"small",style:{pointerEvents:c?"none":void 0},locale:{emptyText:h==="left"?e.jsx(K,{description:"Tidak Ada Tempat Lain Yang Bersinggungan"}):e.jsx(K,{description:"Tidak Ada Tempat Lain Sebagai Pembanding"})},onRow:h==="left"?({key:m,disabled:S})=>({onClick:()=>{S||c||p(m,!k.includes(m))}}):void 0})}})},{Link:Se,Text:Ns}=D,Bs=(t,a)=>{var n,i,o;return((n=a.placeName)==null?void 0:n.includes(t))||((i=a.type.name)==null?void 0:i.includes(t))||((o=a.placeAddress)==null?void 0:o.includes(t))},$s=()=>{const[t,a]=g.useState([]),[n,i]=g.useState(!1),[o,s]=g.useState(),[u,h]=g.useState(null),[x,y]=g.useState([]),[j,k]=g.useState(),c=te({query:"(min-width: 700px)"}),d=T=>{a(T)},p=T=>{i(T)},l=O({queryKey:["place-to-compare"],queryFn:async()=>await Va()}),[r,m]=g.useState(""),[S,L]=g.useState(""),M=g.useRef(null),R=(T,f,v)=>{f({closeDropdown:!0}),m(T[0]),L(v)},I=T=>{T(),m("")},P=T=>({filterDropdown:({setSelectedKeys:f,selectedKeys:v,confirm:q,clearFilters:U,close:le})=>e.jsxs("div",{style:{padding:8},onKeyDown:ae=>ae.stopPropagation(),children:[e.jsx(w,{ref:M,placeholder:`Search ${T}`,value:v[0],onChange:ae=>f(ae.target.value?[ae.target.value]:[]),onPressEnter:()=>R(v,q,T),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>R(v,q,T),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{U&&I(U),q({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{le()},children:"Tutup"})]})]}),filterIcon:f=>e.jsx(H,{style:{color:f?"#1677ff":void 0}}),onFilter:(f,v)=>v[T].toString().toLowerCase().includes(f.toLowerCase()),render:f=>S===T?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[r],autoEscape:!0,textToHighlight:f?f.toString():""}):f}),Y=T=>{y(f=>[...f,T]),console.log(x)},Re=T=>{y(f=>f.filter(v=>v.placeId!==T))},qe=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name",...P("placeName")},{title:"Alamat",dataIndex:"placeAddress",key:"place-address",responsive:["lg"]},{title:"Tipe",dataIndex:"placeType",key:"place-type",width:"150px",responsive:["sm"],render:(T,{type:f})=>e.jsx(Q,{style:{margin:"0"},color:f.label,children:f.name.toUpperCase()})},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"place-create",align:"center",width:"150px",responsive:["md"],sorter:(T,f)=>new Date(f.createdAt).getTime()-new Date(T.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",render:(T,{createdAt:f})=>{const v=J(f);return e.jsx("p",{children:v})}},{title:"Aksi",key:"place-action",align:"center",width:"150px",render:(T,{placeId:f,placeMap:v,placeCenterPoint:q})=>{const U=j===f;return e.jsxs(B,{children:[e.jsx(Se,{disabled:U||x.length!==0,onClick:()=>{s(f),h(q);const le=v.placeGeojson;Y({placeId:f,placeGeo:le}),k(f)},children:"Pilih Tempat"}),e.jsx(Se,{disabled:!U,onClick:()=>{y([]),s(""),h(null),k(null)},children:"Reset Tempat"})]})}}],ze=O({queryKey:["compare-list",o],queryFn:async()=>await Pt(o),enabled:o!=null}),Ke=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name"},{title:"Tipe",dataIndex:"placeType",key:"place-type",width:"150px",render:(T,{type:f})=>e.jsx(Q,{style:{margin:"0"},color:f.label,children:f.name.toUpperCase()})},{title:"Jarak Ke Pusat Lokasi",dataIndex:"rangePlace",key:"place-range"}],Ee=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name"},{title:"Alamat Tempat",dataIndex:"placeAddress",key:"place-address",width:"200px"},{title:"Tampilkan Tempat",key:"place-map",align:"center",width:"150px",render:(T,{placeId:f,placeMap:v})=>{const q=x.some(U=>U.placeId===f);return e.jsxs(B,{size:"middle",children:[e.jsx(Se,{onClick:()=>{const U=v.placeGeojson;Y({placeId:f,placeGeo:U})},disabled:q,children:"Tampil"}),e.jsx(Se,{type:"danger",onClick:()=>{Re(f)},disabled:!q,children:"Hapus"})]})}}],Ue=T=>{T.target._map.fitBounds(T.target.getBounds())};return c?e.jsxs(z,{align:"end",gap:"middle",vertical:!0,children:[e.jsx(Ot,{rowKey:({placeId:T})=>T,dataSource:l.data,columns:qe}),e.jsx(_t,{rowKey:({placeId:T})=>T,dataSource:ze.data,targetKeys:t,disabled:n,showSearch:!0,showSelectAll:!1,onChange:d,filterOption:Bs,leftColumns:Ke,rightColumns:Ee}),e.jsx(ht,{unCheckedChildren:"Kunci Pilihan",checkedChildren:"Buka Pilihan",checked:n,onChange:p}),e.jsxs(ue,{center:[-1.2480891,118],zoom:19,scrollWheelZoom:!1,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u&&e.jsx(at,{position:u}),x&&x.map((T,f)=>e.jsx(Te,{data:T.placeGeo,style:{weight:2,dashArray:"3",fillColor:"transparent",color:At(f)},onEachFeature:(v,q)=>Lt(v,q,Ue)},f))]})]}):e.jsx(fe,{status:"404",title:"Perangkat anda terlalu kecil",subTitle:"Maaf, halaman yang Anda kunjungi tidak dapat ditampilkan secara baik pada perangkat Anda.",extra:e.jsx(Ns,{style:{fontSize:"12px"},children:"Petunjuk: Buka secara lanskap / coba gunakan perangkat lainnya"})})},{Link:we,Text:Fs}=D,Ms=(t,a)=>{var n,i,o;return((n=a.placeName)==null?void 0:n.includes(t))||((i=a.type.name)==null?void 0:i.includes(t))||((o=a.placeAddress)==null?void 0:o.includes(t))},Rs=()=>{const[t,a]=g.useState([]),[n,i]=g.useState(!1),[o,s]=g.useState(),[u,h]=g.useState(null),[x,y]=g.useState([]),[j,k]=g.useState(),c=te({query:"(min-width: 700px)"}),d=T=>{a(T)},p=T=>{i(T)},l=O({queryKey:["user-place-to-compare"],queryFn:async()=>await Wa()}),[r,m]=g.useState(""),[S,L]=g.useState(""),M=g.useRef(null),R=(T,f,v)=>{f({closeDropdown:!0}),m(T[0]),L(v)},I=T=>{T(),m("")},P=T=>({filterDropdown:({setSelectedKeys:f,selectedKeys:v,confirm:q,clearFilters:U,close:le})=>e.jsxs("div",{style:{padding:8},onKeyDown:ae=>ae.stopPropagation(),children:[e.jsx(w,{ref:M,placeholder:`Search ${T}`,value:v[0],onChange:ae=>f(ae.target.value?[ae.target.value]:[]),onPressEnter:()=>R(v,q,T),style:{marginBottom:8,display:"block"}}),e.jsxs(B,{children:[e.jsx(C,{type:"primary",onClick:()=>R(v,q,T),icon:e.jsx(H,{}),size:"small",style:{width:90},children:"Cari"}),e.jsx(C,{onClick:()=>{U&&I(U),q({closeDropdown:!0})},size:"small",style:{width:90},children:"Hapus"}),e.jsx(C,{type:"link",size:"small",onClick:()=>{le()},children:"Tutup"})]})]}),filterIcon:f=>e.jsx(H,{style:{color:f?"#1677ff":void 0}}),onFilter:(f,v)=>v[T].toString().toLowerCase().includes(f.toLowerCase()),render:f=>S===T?e.jsx(ne,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[r],autoEscape:!0,textToHighlight:f?f.toString():""}):f}),Y=T=>{y(f=>[...f,T]),console.log(x)},Re=T=>{y(f=>f.filter(v=>v.placeId!==T))},qe=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name",...P("placeName")},{title:"Alamat",dataIndex:"placeAddress",key:"place-address",responsive:["lg"]},{title:"Tipe",dataIndex:"placeType",key:"place-type",width:"150px",responsive:["sm"],render:(T,{type:f})=>e.jsx(Q,{style:{margin:"0"},color:f.label,children:f.name.toUpperCase()})},{title:"Ditambahkan Pada",dataIndex:"createdAt",key:"place-create",align:"center",width:"150px",responsive:["md"],sorter:(T,f)=>new Date(f.createdAt).getTime()-new Date(T.createdAt).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"ascend",render:(T,{createdAt:f})=>{const v=J(f);return e.jsx("p",{children:v})}},{title:"Aksi",key:"place-action",align:"center",width:"150px",render:(T,{placeId:f,placeMap:v,placeCenterPoint:q})=>{const U=j===f;return e.jsxs(B,{children:[e.jsx(we,{disabled:U||x.length!==0,onClick:()=>{s(f),h(q);const le=v.placeGeojson;Y({placeId:f,placeGeo:le}),k(f)},children:"Pilih Tempat"}),e.jsx(we,{disabled:!U,onClick:()=>{y([]),s(""),h(null),k(null)},children:"Reset Tempat"})]})}}],ze=O({queryKey:["compare-list",o],queryFn:async()=>await Pt(o),enabled:o!=null}),Ke=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name"},{title:"Tipe",dataIndex:"placeType",key:"place-type",width:"150px",render:(T,{type:f})=>e.jsx(Q,{style:{margin:"0"},color:f.label,children:f.name.toUpperCase()})},{title:"Jarak Ke Pusat Lokasi",dataIndex:"rangePlace",key:"place-range"}],Ee=[{title:"Nama Tempat",dataIndex:"placeName",key:"place-name"},{title:"Alamat Tempat",dataIndex:"placeAddress",key:"place-address",width:"200px"},{title:"Tampilkan Tempat",key:"place-map",align:"center",width:"150px",render:(T,{placeId:f,placeMap:v})=>{const q=x.some(U=>U.placeId===f);return e.jsxs(B,{size:"middle",children:[e.jsx(we,{onClick:()=>{const U=v.placeGeojson;Y({placeId:f,placeGeo:U})},disabled:q,children:"Tampil"}),e.jsx(we,{type:"danger",onClick:()=>{Re(f)},disabled:!q,children:"Hapus"})]})}}],Ue=T=>{T.target._map.fitBounds(T.target.getBounds())};return c?e.jsxs(z,{align:"end",gap:"middle",vertical:!0,children:[e.jsx(Ot,{rowKey:({placeId:T})=>T,dataSource:l.data,columns:qe}),e.jsx(_t,{rowKey:({placeId:T})=>T,dataSource:ze.data,targetKeys:t,disabled:n,showSearch:!0,showSelectAll:!1,onChange:d,filterOption:Ms,leftColumns:Ke,rightColumns:Ee}),e.jsx(ht,{unCheckedChildren:"Kunci Pilihan",checkedChildren:"Buka Pilihan",checked:n,onChange:p}),e.jsxs(ue,{center:[-1.2480891,118],zoom:19,scrollWheelZoom:!1,children:[e.jsx(pe,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u&&e.jsx(at,{position:u}),x&&x.map((T,f)=>e.jsx(Te,{data:T.placeGeo,style:{weight:2,dashArray:"3",fillColor:"transparent",color:At(f)},onEachFeature:(v,q)=>Lt(v,q,Ue)},f))]})]}):e.jsx(fe,{status:"404",title:"Perangkat anda terlalu kecil",subTitle:"Maaf, halaman yang Anda kunjungi tidak dapat ditampilkan secara baik pada perangkat Anda.",extra:e.jsx(Fs,{style:{fontSize:"12px"},children:"Petunjuk: Buka secara lanskap / coba gunakan perangkat lainnya"})})},qs=()=>se().role===3?e.jsx(Rs,{}):e.jsx($s,{}),zs=new Jt,Ks=()=>{const t=me(),a=se(),[n,i]=g.useState(!1),{data:o,error:s,isError:u,isFetching:h}=O({queryKey:["login"],queryFn:async()=>await Fa(),enabled:!!t.accessToken,staleTime:3600*1e3});return g.useEffect(()=>{o&&a.setUser({role:o.role,name:o.username,exp:o.exp})},[o]),g.useEffect(()=>{u&&!n&&(t.deleteToken(),a.clearUser(),A.open({type:"error",content:"Sesi Anda Telah Habis, Silahkan Masuk Kembali",duration:5,className:"custom-class",style:{marginTop:"20vh"}}),i(!0))},[u,n]),h?e.jsx(Xa,{}):o&&!s?e.jsx(Pe,{}):e.jsx(Qe,{to:"/auth"})},Es=()=>e.jsx(e.Fragment,{children:e.jsxs(Gt,{client:zs,children:[e.jsx(Yt,{}),e.jsxs(ka,{children:[e.jsx(_,{caseSensitive:!0,path:"/",element:e.jsx(Ks,{}),children:e.jsxs(_,{element:e.jsx(ln,{}),children:[e.jsx(_,{index:!0,element:e.jsx(bn,{})}),e.jsx(_,{caseSensitive:!0,path:"/profile",element:e.jsx(Bn,{})}),e.jsx(_,{caseSensitive:!0,path:"/place-type-action",element:e.jsx(fs,{})}),e.jsx(_,{caseSensitive:!0,path:"/place-action",element:e.jsx(Ds,{})}),e.jsx(_,{caseSensitive:!0,path:"/user-action",element:e.jsx(Ls,{})}),e.jsxs(_,{caseSensitive:!0,path:"/location",element:e.jsx(Pe,{}),children:[e.jsx(_,{caseSensitive:!0,path:"/location/new/desktop",element:e.jsx(Xn,{})}),e.jsx(_,{caseSensitive:!0,path:"/location/new/client",element:e.jsx(Ss,{})}),e.jsx(_,{caseSensitive:!0,path:"/location/new/manual",element:e.jsx(rs,{})}),e.jsx(_,{caseSensitive:!0,path:"/location/update/manual/:id",element:e.jsx(ps,{})})]}),e.jsxs(_,{caseSensitive:!0,path:"/statistic",element:e.jsx(Pe,{}),children:[e.jsx(_,{index:!0,element:e.jsx(qn,{})}),e.jsx(_,{caseSensitive:!0,path:"/statistic/user/:id",element:e.jsx(Un,{})}),e.jsx(_,{caseSensitive:!0,path:"/statistic/place/:id",element:e.jsx(En,{})})]}),e.jsx(_,{caseSensitive:!0,path:"/compare-map",element:e.jsx(qs,{})})]})}),e.jsx(_,{caseSensitive:!0,path:"/auth",element:e.jsx(Dn,{})})]})]})});Wt.createRoot(document.getElementById("root")).render(e.jsx(ta,{basename:"/WhatBorder",children:e.jsx(Es,{})}));
